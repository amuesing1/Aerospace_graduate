(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    154932,       3920]
NotebookOptionsPosition[    143945,       3760]
NotebookOutlinePosition[    145121,       3794]
CellTagsIndexPosition[    145078,       3791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "To ASEN 5007 students: upon downloading this Notebook, check it out by \
following this procedure.\n1.  Compile the initialization cells (1 to 9).  \
For ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " versions <6, use\n          Kernel -> Evaluation -> Evaluate \
Initialization. \n       For  ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " versions 6 or higher, use\n          Kernel-> Evaluate Initialization \
Cells\n     (To get rid of annoying warning messages, you should initialize \
twice. )\n     Verify that the output  of the initialized cells,  which is  \
generated by the test statements in blue,\n      agrees with Chapter 4 \
Figures.\n2.  Pick Cell 10 by clicking mouse on interior of cell.  Execute by \
pressing <Shift-Enter> on a\n     Windows PC or newer Macs, <Enter> on older \
Macs.  Check that answers agree with Chapter 4.\n     Repeat for Cells 11 and \
12.  Note that for these the analysis is ",
 StyleBox["symbolic, not numerical, ",
  FontWeight->"Bold"],
 "so\n     the print utilities of Cell 6 as well as the plot utilities of \
Cells 7-9 should ",
 StyleBox["not ",
  FontWeight->"Bold"],
 "be used.\n3.  Do HW Exercise 4.1  by writing scripts in Cells 13 & 14. \
using scripts in Cells 10-11 as \"templates\"\n     Recommendation: go step \
by step; dont try to write the whole thing and run all at once."
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 FontFamily->"Times New Roman",
 FontSize->14,
 Background->RGBColor[
  1, 0.719951, 
   0.200015],ExpressionUUID->"99c0207a-b215-49b5-a08b-8cfc8dd34344"],

Cell[TextData[{
 StyleBox["Cell 1:",
  FontWeight->"Bold"],
 " Module to form element stiffness of plane truss element (a 2-node bar) in \
global coordinates"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"ed527a14-88e0-4da5-b042-bead67c80f1f"],

Cell[CellGroupData[{

Cell[TextData[{
 "PlaneBarStiffness[{{x1_,y1_},{x2_,y2_}},Em_,A_]:=Module[\n  \
{c,s,x21=x2-x1,y21=y2-y1,LLe,Le,Ke}, LLe=x21^2+y21^2;\n   \
Le=PowerExpand[Sqrt[LLe]]; c=x21/Le; s=y21/Le;\n   Ke=(Em*A/Le)*{{ c^2, \
c*s,-c^2,-c*s},\n                 { c*s, s^2,-s*c,-s^2},\n                 \
{-c^2,-s*c, c^2, s*c},\n                 {-s*c,-s^2, s*c, s^2}}; \n   \
Return[Ke]];\n    \n",
 StyleBox["Ke= PlaneBarStiffness[{{0,0},{10,10}},100,2*Sqrt[2]];\n\
Print[\"Numerical Elem Stiff Matrix: \",Ke//MatrixForm];\nClearAll[Em,A,L]; \
Ke= PlaneBarStiffness[{{0,0},{L,L}},Em,A];\nKe=Simplify[Ke,L>0]; \
fac=Em*A/(2*Sqrt[2]*L); Kesc=Simplify[Ke/fac];\nPrint[\"Symb Elem Stiff \
Matrix: \",Ke//MatrixForm,\n  \" = \",fac,\"*\",Kesc//MatrixForm];",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[608]:=",ExpressionUUID->"f1a263b5-4df1-428f-9020-5de24e4960a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical Elem Stiff Matrix: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"10", "10", 
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}]},
       {"10", "10", 
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}]},
       {
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}], "10", "10"},
       {
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}], "10", "10"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Numerical Elem Stiff Matrix: ", 
   MatrixForm[{{10, 10, -10, -10}, {10, 10, -10, -10}, {-10, -10, 10, 
    10}, {-10, -10, 10, 10}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757439990754*^9, 3.7457590164170923`*^9, 
  3.7457612425364857`*^9},
 CellLabel->
  "During evaluation of \
In[608]:=",ExpressionUUID->"44c41cbc-d905-4730-b4e9-de8ca1df8aa0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Symb Elem Stiff Matrix: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}]},
       {
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"A", " ", "Em"}], 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "L"}]]}], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]], 
        FractionBox[
         RowBox[{"A", " ", "Em"}], 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "L"}]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" = \"\>", 
   "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"A", " ", "Em"}], 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", "L"}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "1", 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}]},
       {"1", "1", 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}]},
       {
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], "1", "1"},
       {
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], "1", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Symb Elem Stiff Matrix: ", 
   MatrixForm[{{
     Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L}, {
     Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L}, {
     Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L}, {
     Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[-1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, 
      Rational[1, 2] 
      2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L}}], 
   " = ", Rational[1, 2] 
   2^Rational[-1, 2] $CellContext`A $CellContext`Em/$CellContext`L, "*", 
   MatrixForm[{{1, 1, -1, -1}, {1, 1, -1, -1}, {-1, -1, 1, 1}, {-1, -1, 1, 
    1}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757439990754*^9, 3.7457590164170923`*^9, 
  3.7457612425440083`*^9},
 CellLabel->
  "During evaluation of \
In[608]:=",ExpressionUUID->"088ddd78-dba5-47ca-9c9a-96e0ca030f0c"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 2:",
  FontWeight->"Bold"],
 " Module to assemble master stiffness matrix of a plane truss"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"3add9e48-c5a1-4fce-9220-b4c31ce09fd3"],

Cell[CellGroupData[{

Cell[TextData[{
 "PlaneTrussMasterStiffness[nodxyz_,elenod_,elemat_,elefab_]:=\n  \
Module[{numele=Length[elenod],numnod=Length[nodxyz],e,eft,\n  \
ni,nj,ncoor,Em,A,Ke,K}, K=Table[0,{2*numnod},{2*numnod}];\n  For \
[e=1,e<=numele,e++, {ni,nj}=elenod[[e]];\n       \
eft={2*ni-1,2*ni,2*nj-1,2*nj};\n       ncoor={nodxyz[[ni]],nodxyz[[nj]]}; \n  \
     Em=elemat[[e]]; A=elefab[[e]];\n       Ke=PlaneBarStiffness[ncoor,Em,A]; \
\n       For [i=1,i<=4,i++, ii=eft[[i]];\n            For [j=i,j<=4,j++, \
jj=eft[[j]];\n                 K[[jj,ii]]=K[[ii,jj]]+=Ke[[i,j]]; \n           \
     ];\n            ];\n      ]; Return[K]];\n\n",
 StyleBox["nodxyz={{0,0},{10,0},{10,10}}; elenod={{1,2},{2,3},{1,3}};\n\
elemat={100,100,100}; elefab={1,1/2,2*Sqrt[2]};  \n\
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];\nPrint[\"Master \
stiffness of example truss: \",K//MatrixForm];",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[615]:=",ExpressionUUID->"9861b3eb-a3f0-4515-a1f1-2ff73b25ed47"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Master stiffness of example truss: \"\>", "\[InvisibleSpace]", 
   
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"20", "10", 
        RowBox[{"-", "10"}], "0", 
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}]},
       {"10", "10", "0", "0", 
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}]},
       {
        RowBox[{"-", "10"}], "0", "10", "0", "0", "0"},
       {"0", "0", "0", "5", "0", 
        RowBox[{"-", "5"}]},
       {
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}], "0", "0", "10", "10"},
       {
        RowBox[{"-", "10"}], 
        RowBox[{"-", "10"}], "0", 
        RowBox[{"-", "5"}], "10", "15"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Master stiffness of example truss: ", 
   MatrixForm[{{20, 10, -10, 0, -10, -10}, {10, 10, 0, 0, -10, -10}, {-10, 0, 
    10, 0, 0, 0}, {0, 0, 0, 5, 0, -5}, {-10, -10, 0, 0, 10, 10}, {-10, -10, 
    0, -5, 10, 15}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7457574401065693`*^9, 3.745759016540204*^9, 
  3.745761242570285*^9},
 CellLabel->
  "During evaluation of \
In[615]:=",ExpressionUUID->"14a9e49e-9222-453b-9016-372055fd9d96"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 3:",
  FontWeight->"Bold"],
 "  Modules to apply homogeneous, single-freedom displacement BCs on master \
stiffness and forces.\nPrescribed nonzero displacements are allowed. These \
modules also work, without any change, for more general FEM models."
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"adde7bf0-3bea-4eda-a799-9936c96a19d1"],

Cell[CellGroupData[{

Cell[TextData[{
 "AppliedForceVector[nodtag_,nodval_]:= Module[{i,ftag,fval,\n numdof,f}, \
{ftag,fval}={Flatten[nodtag],Flatten[nodval]};\n numdof=Length[ftag]; \
f=Table[0,{numdof}]; \n",
 StyleBox[" ",
  FontColor->RGBColor[1, 0, 0]],
 "For [i=1,i<=numdof,i++, If [ftag[[i]]==0, f[[i]]=fval[[i]]]];\n Return[f]]; \
\n\nModifiedMasterStiffness[nodtag_,K_] := Module[\n \
{i,j,k,n=Length[K],pdof,np,Kmod=K},\n  pdof=PrescDispDOFTags[nodtag]; \
np=Length[pdof];",
 StyleBox[" ",
  FontColor->RGBColor[1, 0, 0]],
 "\n  For [k=1,k<=np,k++, i=pdof[[k]]; \n      For [j=1,j<=n,j++, \
Kmod[[i,j]]=Kmod[[j,i]]=0];\n      Kmod[[i,i]]=1]; \n  Return[Kmod]];  \n  \n\
ModifiedNodeForces[nodtag_,nodval_,K_,f_]:= Module[\n \
{i,j,k,n=Length[K],pdof,pval,np,d,c,fmod=f},\n  \
pdof=PrescDispDOFTags[nodtag]; np=Length[pdof]; \n  pval=",
 "PrescDispDOF",
 "Values[nodtag,nodval]; c=Table[1,{n}]; \n  For [k=1,k<=np,k++, i=pdof[[k]]; \
c[[i]]=0];\n  For [k=1,k<=np,k++, i=pdof[[k]]; d=pval[[k]]; \n      \
fmod[[i]]=d; If [d==0, Continue[]];\n      For [j=1,j<=n,j++, \
fmod[[j]]-=K[[i,j]]*c[[j]]*d]; \n      ];  ClearAll[c]; \n  Return[fmod]];\n  \
\nPrescDispDOFTags[nodtag_]:= Module[\n  \
{j,n,numnod=Length[nodtag],pdof={},k=0,m},\n  For [n=1,n<=numnod,n++, \
m=Length[nodtag[[n]]];\n      For [j=1,j<=m,j++, If [nodtag[[n,j]]>0, \n      \
          AppendTo[pdof,k+j]]]; k+=m;\n      ]; Return[pdof]]; \n     \n\
PrescDispDOFValues[nodtag_,nodval_]:= Module[\n \
{j,n,numnod=Length[nodtag],pval={},k=0,m},\n  For [n=1,n<=numnod,n++, \
m=Length[nodtag[[n]]];\n      For [j=1,j<=m,j++, If [nodtag[[n,j]]>0, \n      \
          AppendTo[pval,nodval[[n,j]]]]]; k+=m;\n      ]; Return[pval]];\n    \
 \n",
 StyleBox["nodtag={{1,1},{0,1},{0,0}}; nodval={{-1,2},{0,3},{2,1}};\n\
K={{K11,K12,K13,K14,K15,K16},{K12,K22,K23,K24,K25,K26}, \n   \
{K13,K23,K33,K34,K35,K36},{K14,K24,K34,K44,K45,K46},\n   \
{K15,K25,K35,K45,K55,K56},{K16,K26,K36,K46,K56,K66}};\nPrint[\"K before \
BC:\",K//MatrixForm];",
  FontColor->RGBColor[0, 0, 1]],
 "\n",
 StyleBox["f=AppliedForceVector[nodtag,nodval];\nPrint[\"f before BC:\",f];",
  FontColor->RGBColor[0, 0, 1]],
 "  ",
 StyleBox["  \nKmod=ModifiedMasterStiffness[nodtag,K];\nPrint[\"K modified \
for BC:\",Kmod//MatrixForm];\nfmod=ModifiedNodeForces[nodtag,nodval,K,f];\n\
Print[\"f modified for BC:\",fmod]; ",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[621]:=",ExpressionUUID->"68b32348-52af-4795-9126-c01785521edd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"K before BC:\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"K11", "K12", "K13", "K14", "K15", "K16"},
       {"K12", "K22", "K23", "K24", "K25", "K26"},
       {"K13", "K23", "K33", "K34", "K35", "K36"},
       {"K14", "K24", "K34", "K44", "K45", "K46"},
       {"K15", "K25", "K35", "K45", "K55", "K56"},
       {"K16", "K26", "K36", "K46", "K56", "K66"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["K before BC:", 
   MatrixForm[{{$CellContext`K11, $CellContext`K12, $CellContext`K13, \
$CellContext`K14, $CellContext`K15, $CellContext`K16}, {$CellContext`K12, \
$CellContext`K22, $CellContext`K23, $CellContext`K24, $CellContext`K25, \
$CellContext`K26}, {$CellContext`K13, $CellContext`K23, $CellContext`K33, \
$CellContext`K34, $CellContext`K35, $CellContext`K36}, {$CellContext`K14, \
$CellContext`K24, $CellContext`K34, $CellContext`K44, $CellContext`K45, \
$CellContext`K46}, {$CellContext`K15, $CellContext`K25, $CellContext`K35, \
$CellContext`K45, $CellContext`K55, $CellContext`K56}, {$CellContext`K16, \
$CellContext`K26, $CellContext`K36, $CellContext`K46, $CellContext`K56, \
$CellContext`K66}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7457574401231194`*^9, 3.74575901656107*^9, 
  3.7457612425851297`*^9},
 CellLabel->
  "During evaluation of \
In[621]:=",ExpressionUUID->"6fa96954-6347-4c61-b0a7-30254e6242c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f before BC:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "1"}], "}"}]}],
  SequenceForm["f before BC:", {0, 0, 0, 0, 2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7457574401231194`*^9, 3.74575901656107*^9, 
  3.7457612425865097`*^9},
 CellLabel->
  "During evaluation of \
In[621]:=",ExpressionUUID->"9d03654b-d246-431d-a336-81c1b1335eeb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"K modified for BC:\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0"},
       {"0", "0", "K33", "0", "K35", "K36"},
       {"0", "0", "0", "1", "0", "0"},
       {"0", "0", "K35", "0", "K55", "K56"},
       {"0", "0", "K36", "0", "K56", "K66"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["K modified for BC:", 
   MatrixForm[{{1, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0}, {
     0, 0, $CellContext`K33, 0, $CellContext`K35, $CellContext`K36}, {0, 0, 0,
      1, 0, 0}, {
     0, 0, $CellContext`K35, 0, $CellContext`K55, $CellContext`K56}, {
     0, 0, $CellContext`K36, 0, $CellContext`K56, $CellContext`K66}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7457574401231194`*^9, 3.74575901656107*^9, 
  3.745761242587453*^9},
 CellLabel->
  "During evaluation of \
In[621]:=",ExpressionUUID->"a9061036-da1f-4306-9cea-08e4e26557da"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f modified for BC:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "2", ",", 
     RowBox[{"K13", "-", 
      RowBox[{"2", " ", "K23"}], "-", 
      RowBox[{"3", " ", "K34"}]}], ",", "3", ",", 
     RowBox[{"2", "+", "K15", "-", 
      RowBox[{"2", " ", "K25"}], "-", 
      RowBox[{"3", " ", "K45"}]}], ",", 
     RowBox[{"1", "+", "K16", "-", 
      RowBox[{"2", " ", "K26"}], "-", 
      RowBox[{"3", " ", "K46"}]}]}], "}"}]}],
  SequenceForm[
  "f modified for BC:", {-1, 2, $CellContext`K13 - 2 $CellContext`K23 - 
    3 $CellContext`K34, 3, 2 + $CellContext`K15 - 2 $CellContext`K25 - 
    3 $CellContext`K45, 1 + $CellContext`K16 - 2 $CellContext`K26 - 
    3 $CellContext`K46}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7457574401231194`*^9, 3.74575901656107*^9, 
  3.745761242588497*^9},
 CellLabel->
  "During evaluation of \
In[621]:=",ExpressionUUID->"eb023cb6-2fbe-4392-b990-c72364aeeb5b"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 4: ",
  FontWeight->"Bold"],
 " Module to compute the internal axial  force in a plane , 2-node bar element"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"4851dbbf-2dc3-4d8d-80b8-4e5139f9e8ff"],

Cell[CellGroupData[{

Cell[TextData[{
 "PlaneBarIntForce[{{x1_,y1_},{x2_,y2_}},Em_,A_,ue_]:= Module[\n  \
{x21=x2-x1,y21=y2-y1,dux,duy,LLe,pe}, LLe=x21^2+y21^2;\n  \
dux=ue[[3]]-ue[[1]]; duy=ue[[4]]-ue[[2]];\n  pe=(Em*A/LLe)*(x21*dux+y21*duy);\
\n  Return[pe]]; \n  \n",
 StyleBox["pe=PlaneBarIntForce[{{0,0},{10,10}},100,2*Sqrt[2],{0,0,0.4,-0.2}];\
\nPrint[\"Bar int force (numerical): \",pe]; \n\
ClearAll[Em,A,L,ux1,uy1,ux3,uy3];\n\
pe=PlaneBarIntForce[{{0,0},{L,L}},Em,A,{ux1,uy1,ux3,uy3}];\nPrint[\"Bar int \
force (symbolic): \",Simplify[pe]];",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[640]:=",ExpressionUUID->"f3265032-5223-401d-bbf1-6219facda383"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Bar int force (numerical): \"\>", "\[InvisibleSpace]", 
   "2.8284271247461903`"}],
  SequenceForm["Bar int force (numerical): ", 2.8284271247461903`],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757440140902*^9, 3.7457590165818853`*^9, 
  3.7457612426007967`*^9},
 CellLabel->
  "During evaluation of \
In[640]:=",ExpressionUUID->"e07da477-d295-4b4e-ac11-07ffd272b2e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Bar int force (symbolic): \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"A", " ", "Em", " ", 
      RowBox[{"(", 
       RowBox[{"ux1", "-", "ux3", "+", "uy1", "-", "uy3"}], ")"}]}], 
     RowBox[{"2", " ", "L"}]]}]}],
  SequenceForm[
  "Bar int force (symbolic): ", 
   Rational[-1, 
     2] $CellContext`A $CellContext`Em $CellContext`L^(-1) ($CellContext`ux1 - \
$CellContext`ux3 + $CellContext`uy1 - $CellContext`uy3)],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757440140902*^9, 3.7457590165818853`*^9, 
  3.745761242601995*^9},
 CellLabel->
  "During evaluation of \
In[640]:=",ExpressionUUID->"5d3be4d1-18e1-4708-a72e-5e5a50281860"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 5:",
  FontWeight->"Bold"],
 "  Modules to get internal forces and stresses in plane truss members"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"3984a890-fb5a-4658-912c-5b0b3e551707"],

Cell[CellGroupData[{

Cell[TextData[{
 "PlaneTrussIntForces[nodxyz_,elenod_,elemat_,elefab_,noddis_]:= \n  \
Module[{numele=Length[elenod],e,ni,nj,encoor,Em,A,ue,elefor},\n  \
elefor=Table[0,{numele}];\n  For [e=1,e<=numele,e++, {ni,nj}=elenod[[e]];\n   \
    encoor={nodxyz[[ni]],nodxyz[[nj]]};  \n       Em=elemat[[e]]; \
A=elefab[[e]];\n       ue=Flatten[{noddis[[ni]],noddis[[nj]]}];\n       \
elefor[[e]]=PlaneBarIntForce[encoor,Em,A,ue];\n      ]; \n  Return[elefor]];\n\
\nPlaneTrussStresses[elefab_,elefor_]:= Module[\n \
{numele=Length[elefab],e,elesig}, elesig=Table[0,{numele}];\n  For \
[e=1,e<=numele,e++, elesig[[e]]=elefor[[e]]/elefab[[e]] ];\n  \
Return[elesig]];\n",
 StyleBox["\nnodxyz={{0,0},{10,0},{10,10}}; elenod={{1,2},{2,3},{1,3}};\n\
elemat={100,100,100}; elefab={1,1/2,2*Sqrt[2]}; \n\
noddis={{0,0},{0,0},{0.4,-0.2}};\n\
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];\n\
Print[\"Internal bar forces in example truss:\",N[elefor]];\n\
elesig=PlaneTrussStresses[elefab,elefor];\nPrint[\"Bar stresses in example \
truss:\",N[elesig]];",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[647]:=",ExpressionUUID->"7b2405e8-50b3-4899-8ec4-41e553f2b7c6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Internal bar forces in example truss:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "1.`"}], ",", "2.8284271247461903`"}], "}"}]}],
  SequenceForm[
  "Internal bar forces in example truss:", {0., -1., 2.8284271247461903`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757440157207*^9, 3.745759016598982*^9, 
  3.745761242613538*^9},
 CellLabel->
  "During evaluation of \
In[647]:=",ExpressionUUID->"b1cc7aa7-e1e1-4eb6-a0b1-37e35210dde5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Bar stresses in example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "2.`"}], ",", "1.`"}], "}"}]}],
  SequenceForm["Bar stresses in example truss:", {0., -2., 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757440157207*^9, 3.745759016598982*^9, 
  3.74576124261487*^9},
 CellLabel->
  "During evaluation of \
In[647]:=",ExpressionUUID->"96416fc0-ff93-499b-89a9-47764618a0df"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 6.",
  FontWeight->"Bold"],
 "  Print utilities and auxiliary modules for array partition"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"79c1e5c3-f686-4184-b173-61f563cf5145"],

Cell[TextData[{
 "PrintPlaneTrussNodeCoordinates[nodxyz_,title_,digits_]:= Module[\n  \
{numnod=Length[nodxyz],n,x,y,z,d=6,f=6,tab}, \n  tab=Table[0,{numnod}]; If \
[Length[digits]==2,{d,f}=digits];\n   For \
[n=1,n<=numnod,n++,{x,y}=nodxyz[[n]]; \n       \
tab[[n]]={ToString[n],PaddedForm[x,{d,f}],PaddedForm[y,{d,f}]}];\n   If \
[StringLength[title]>0, Print[title]];\n   Print[TableForm[tab, \
TableAlignments->{Right},   \n      \
TableDirections->{Column,Row},TableSpacing->{0,2},\n      TableHeadings \
->{None,{\"node\", \"x-coor\", \"y-coor\"}}]];\n   ClearAll[tab];\n   ];\n   \
\nPrintPlaneTrussElementData[elenod_,elemat_,elefab_,title_,digits_]:= \
Module[\n  {e,numele=Length[elenod],Em,A,d=6,f=3,tab}, \n  \
tab=Table[0,{numele}]; If [Length[digits]==2,{d,f}=digits];\n   For \
[e=1,e<=numele,e++, Em=elemat[[e]]; A=elefab[[e]];\n        \
tab[[e]]={ToString[e],ToString[elenod[[e]]],\n             \
PaddedForm[Em,{d,f}],PaddedForm[A,{d,f}]}];\n   If [StringLength[title]>0, \
Print[title]];\n   Print[TableForm[tab, TableAlignments->{Right},\n         \
TableDirections->{Column,Row},TableSpacing->{0,2},\n         TableHeadings \
->{None,{\"elem\", \"nodes\", \"modulus\", \"area\"}}]];\n   ClearAll[tab];\n \
  ];\n   \nPrintPlaneTrussFreedomActivity[nodtag_,nodval_,title_,digits_]:= \
Module[\n  {numnod=Length[nodtag],n,t,v,tab}, \n   tab=Table[0,{numnod}]; If \
[Length[digits]==2,{d,f}=digits];\n   For [n=1,n<=numnod,n++, t=nodtag[[n]]; \
v=nodval[[n]];\n        tab[[n]]={ToString[n],\n          \
PaddedForm[t[[1]]],PaddedForm[t[[2]]],\n          \
PaddedForm[v[[1]]],PaddedForm[v[[2]]]}];\n   If [StringLength[title]>0, \
Print[title]];\n   Print[TableForm[tab,TableAlignments->{Right},\n         \
TableDirections->{Column,Row},TableSpacing->{0,1},\n         TableHeadings \
->{None,{\"node\", \"x-tag\", \"y-tag\",\n                          \"x-value\
\", \"y-value\"}} ]];\n   ClearAll[tab];\n   ];\n\n\
PrintPlaneTrussNodeDisplacements[noddis_,title_,digits_]:= Module[\n  \
{numnod=Length[noddis],n,ux,uy,tab,d=6,f=6}, \n  tab=Table[0,{numnod}]; If \
[Length[digits]==2,{d,f}=digits];\n   For [n=1,n<=numnod,n++, \
{ux,uy}=noddis[[n]]; \n       \
tab[[n]]={ToString[n],PaddedForm[ux,{d,f}],PaddedForm[uy,{d,f}]}];\n   If \
[StringLength[title]>0, Print[title]];\n   \
Print[TableForm[tab,TableAlignments->{Right},\n         \
TableDirections->{Column,Row},TableSpacing->{0,1},\n         TableHeadings \
->{None,{\"node\", \"x-displ\", \"y-displ\"}}]];\n   ClearAll[tab];\n   ];\n\n\
PrintPlaneTrussNodeForces[nodfor_,title_,digits_]:= Module[\n  \
{numnod=Length[nodfor],n,fx,fy,tab,d=4,f=4}, \n  tab=Table[0,{numnod}]; If \
[Length[digits]==2,{d,f}=digits];\n   For [n=1,n<=numnod,n++, \
{fx,fy}=nodfor[[n]]; \n       \
tab[[n]]={ToString[n],PaddedForm[fx,{d,f}],PaddedForm[fy,{d,f}]}];\n   If \
[StringLength[title]>0, Print[title]];\n   \
Print[TableForm[tab,TableAlignments->{Right},\n         \
TableDirections->{Column,Row},TableSpacing->{0,1},\n         TableHeadings \
->{None,{\"node\", \"x-force\", \"y-force\"}}]];\n   ClearAll[tab];\n   ];\n  \
 \nPrintPlaneTrussElemForcesAndStresses[elefor_,elesig_,title_,digits_]:= \n  \
Module[{numele=Length[elefor],e,p,s,d=4,f=4,tab}, \n   tab=Table[0,{numele}]; \
If [Length[digits]==2,{d,f}=digits];\n   For [e=1,e<=numele,e++, \
p=elefor[[e]]; s=elesig[[e]];\n       \
tab[[e]]={ToString[e],PaddedForm[p,{d,f}],PaddedForm[s,{d,f}]} ]; \n   If \
[StringLength[title]>0, Print[title]];\n   \
Print[TableForm[tab,TableAlignments->{Right},\n         \
TableDirections->{Column,Row},TableSpacing->{0,1}, \n         TableHeadings \
->{None,{\"elem\", \"axial force\", \"axial stress\"}}]];\n   ClearAll[tab];\n\
   ]; \n \nFlatNodePartVector[nv_]:=Flatten[nv];\n           \n\
NodePartFlatVector[nfc_,v_]:= Module[{i,k,m,n,nv={},numnod},\n  If \
[Length[nfc]==0, nv=Partition[v,nfc]];\n  If [Length[nfc]>0,  \
numnod=Length[nfc]; m=0;\n      nv=Table[0,{numnod}];   \n      For \
[n=1,n<=numnod,n++, k=nfc[[n]]; \n          nv[[n]]=Table[v[[m+i]],{i,1,k}]; \
\n          m+=k]];\n  Return[nv]];",
 StyleBox["\n\n(*nodxyz={{0,0},{10,0},{10,10}};\n\
PrintPlaneTrussNodeCoordinates[nodxyz,\"Test node coord print\",{6,4}];\n\
elenod={{1,2},{2,3},{1,3}}; elemat={100,100,100}; \
elefab=N[{1,1/2,2*Sqrt[2]}];\n\
PrintPlaneTrussElementData[elenod,elemat,elefab,\"Test elem data \
print\",{7,3}];\nnodtag={{1,1},{0,1},{0,0}}; nodval={{0,0},{0,0},{2,1}};\n\
PrintPlaneTrussFreedomActivity[nodtag,nodval,\"Test DOF activity print\",{}];\
\nnoddis={{0,0},{0,0},{0.4,-0.2}}; \nPrintPlaneTrussNodeDisplacements[noddis,\
\"Test node disp print\",{}];\nnodfor={{0,0},{0,0},{2,1}}; \n\
PrintPlaneTrussNodeForces[nodfor,\"Test node force print\",{8,4}];\n\
elefor={3,4,5}; elesig={3,2,2.5};\n\
PrintPlaneTrussElemForcesAndStresses[elefor,elesig,\"Test elem force & stress \
print\",{}];\nu={1,2,3,4,5,6}; noddis=NodePartFlatVector[2,u];\n\
Print[\"u=\",u//MatrixForm,\" noddis=\",noddis//MatrixForm];*)",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[658]:=",ExpressionUUID->"fcdab949-dd7b-45ce-869d-d43ec15c3414"],

Cell[TextData[{
 StyleBox["Cell 7.",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["  Plot of elements and nodes of plane truss model",
  FontColor->GrayLevel[0]]
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 FontColor->RGBColor[1, 1, 0],
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"42c6ca91-2147-4a35-9992-965a4af84f18"],

Cell[TextData[{
 "PlotPlaneTrussElements[nodxyz_,elenod_,title_,\n \
{aspect_,imgsiz_,labels_}]:= \n  \
Module[{numnod=Length[nodxyz],numele=Length[elenod],e,n,ni,nj,\n  \
x,y,xmin,xmax,ymin,ymax,dx,dy,xyc,arat,dfun,pbars={}},\n  \
x=y=Table[0,{numnod}]; \n  For [n=1,n<=numnod,n++, \
{x[[n]],y[[n]]}=nodxyz[[n]]];\n  \
{xmin,xmax,ymin,ymax}=N[{Min[x],Max[x],Min[y],Max[y]}];\n  \
{dx,dy}={xmax-xmin,ymax-ymin};\n  For [e=1,e<=numele,e++, \
{ni,nj}=elenod[[e]]; \n       xyc={{x[[ni]],y[[ni]]},{x[[nj]],y[[nj]]}};      \
\n       AppendTo[pbars,Graphics[Line[xyc]]]];\n arat=AspectRatio->Automatic; \
If [aspect>0, arat=AspectRatio->aspect];\n dfun=If [$VersionNumber>=6.0, \
Print, $DisplayFunction];\n If [aspect==0&&dx>0, arat=AspectRatio->dy/dx];\n \
Show[Graphics[AbsoluteThickness[2]],Graphics[RGBColor[0,0,0]],\n      pbars, \
arat, ImageSize->imgsiz, PlotLabel->title,\n      DisplayFunction->dfun ];\n \
ClearAll[pbars];\n ];\n\n\
PlotPlaneTrussElementsAndNodes[nodxyz_,elenod_,title_,\n \
{aspect_,imgsiz_,labels_}]:= Module[{numnod=Length[nodxyz],\n  \
numele=Length[elenod],k=Length[labels],e,n,ni,nj,x,y,xyc,\n  \
xy0,xyn,xmin,xmax,ymin,ymax,elabels,nlabels,fntinfo,\n  \
labnod,frn,fex,fey,labele,fre,fntnam,fntsiz,fntwgt,fntslt,\n  \
black,red,green,blue,yellow,fill,grey,nofill,arat,\n  \
style,dx,dy,dmin,rn,re,ex,ey,elab,nlab,pbars={},\n  \
pecirc={},pelab={},pedisk={},pncirc={},pndisk={},pnlab={} },\n  \
x=y=Table[0,{numnod}];\n  \
{labnod,frn,fex,fey,labele,fre,fntnam,fntsiz,fntwgt,fntslt}=\n    \
{True,0.03,-1.5,0.8,True,0.03,\"Times\",12,\"Plain\",\"Plain\"};  \n  If \
[k>=1, nlabels=labels[[1]] ]; \n  If [k>=2, elabels=labels[[2]] ];\n  If \
[k>=3, fntinfo=labels[[3]] ];\n  If [Length[nlabels]>=1, labnod=nlabels[[1]] \
];\n  If [Length[nlabels]>=2, frn=   nlabels[[2]] ];\n  If \
[Length[nlabels]>=3, fex=   nlabels[[3]] ];\n  If [Length[nlabels]>=4, fey=   \
nlabels[[4]] ];\n  If [Length[elabels]>=1, labele=elabels[[1]] ];\n  If \
[Length[elabels]>=2, fre=   elabels[[2]] ];\n  If [Length[fntinfo]>=1, \
fntnam=fntinfo[[1]] ];\n  If [Length[fntinfo]>=2, fntsiz=fntinfo[[2]] ];\n  \
If [Length[fntinfo]>=3, fntwgt=fntinfo[[3]] ];\n  If [Length[fntinfo]>=4, \
fntslt=fntinfo[[4]] ];\n  For [n=1,n<=numnod,n++, \
{x[[n]],y[[n]]}=nodxyz[[n]]];\n  \
{xmin,xmax,ymin,ymax}=N[{Min[x],Max[x],Min[y],Max[y]}];\n  \
{dx,dy}={xmax-xmin,ymax-ymin}; dmin=Min[dx,dy];\n  rn=frn*dmin; re=fre*dmin;\n\
  style=TextStyle->{FontFamily->fntnam,FontSize-> fntsiz,\n                   \
 FontWeight->fntwgt,FontSlant->fntslt};\n  For [e=1,e<=numele,e++, \
{ni,nj}=elenod[[e]]; \n      xyc={{x[[ni]],y[[ni]]},{x[[nj]],y[[nj]]}};\n     \
 xy0=(xyc[[1]]+xyc[[2]])/2;\n      AppendTo[pbars,Graphics[Line[xyc]]];\n     \
 If [labele, elab=ToString[e];\n          AppendTo[pedisk, \
Graphics[Disk[xy0,re]]]; \n          AppendTo[pecirc, \
Graphics[Circle[xy0,re]]];\n          AppendTo[pelab,  \
Graphics[Text[elab,xy0-{0,0.2*re},style]]]\n         ];\n      ];\n  \
style=TextStyle->{FontFamily->fntnam,FontSize-> fntsiz,\n                    \
FontWeight->\"Bold\",FontSlant->\"Plain\"};\n  For [n=1,n<=numnod,n++,  \
xyn={x[[n]],y[[n]]}; \n      AppendTo[pndisk,  Graphics[Disk[xyn,rn]]];\n     \
 AppendTo[pncirc,  Graphics[Circle[xyn,rn]]];\n      If [labnod, \
nlab=ToString[n]; xy0=xyn+{fex,fey}*rn; \n          AppendTo[pnlab, \
Graphics[Text[nlab,xy0,style]]]];\n     ]; \n  \
{black,red,green,blue,yellow}={RGBColor[0,0,0],RGBColor[1,0,0],\n     \
RGBColor[0,1,0],RGBColor[0,0,1],RGBColor[1,1,0]};\n  \
{nofill,grey,fill}={GrayLevel[0],GrayLevel[.8],GrayLevel[1]};\n  \
arat=AspectRatio->Automatic; \n  If [aspect>0, arat=AspectRatio->aspect];\n  \
If [aspect==0&&dx>0, arat=AspectRatio->dy/dx];\n  dfun=If \
[$VersionNumber>=6.0, Print, $DisplayFunction];\n  \
Show[Graphics[nofill],Graphics[AbsoluteThickness[3]],\n       \
Graphics[red],pbars, Graphics[AbsoluteThickness[1]],\n       \
Graphics[fill],pndisk, Graphics[nofill],pncirc, \n       Graphics[yellow], \
pedisk, Graphics[nofill], \n       Graphics[black], pecirc, pelab, pnlab,\n   \
    arat, ImageSize->imgsiz, PlotLabel->title,\n       DisplayFunction->dfun \
];\n   ClearAll[pbars,pndisk,pncirc,pedisk,pecirc,pelab];\n ];\n \n(*",
 StyleBox["nodxyz={{0,0},{10,5},{10,0},{20,8},{20,0},{30,9},\n       \
{30,0},{40,8},{40,0},{50,5},{50,0},{60,0}};\nnodxyz=N[nodxyz];\n\
elenod={{1,3},{3,5},{5,7},{7,9},{9,11},{11,12},\n        \
{1,2},{2,4},{4,6},{6,8},{8,10},{10,12},\n        \
{2,3},{4,5},{6,7},{8,9},{10,11},\n        {2,5},{4,7},{7,8},{9,10}};\n\
PlotPlaneTrussElements[nodxyz,elenod,\"plain mesh\",{0,500,{}}];\n\
labels={{True,0.05,-2.0,2.0},{True,0.15},{\"Times\",12,\"Plain\",\"Italic\"}};\
\nPlotPlaneTrussElementsAndNodes[nodxyz,elenod,\"mesh with \
labels\",{-1,500,labels}];*)",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[675]:=",ExpressionUUID->"2d01e7f0-2684-4c51-8f6c-297ff926e212"],

Cell[TextData[{
 StyleBox["Cell 8",
  FontWeight->"Bold"],
 ".  Plot plane truss deformed shape"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"aacd0353-6210-435e-a707-786abfea16a9"],

Cell[TextData[{
 "PlotPlaneTrussDeformedShape[nodxyz_,elenod_,noddis_,\n    \
amplif_,box_,title_,{aspect_,imgsiz_,colors_}]:= \n  \
Module[{numnod=Length[nodxyz],numele=Length[elenod],a={},c={},e,k,m,n,\n  \
ni,nj,nf,xbox,ybox,x,y,x0,y0,xmin,xmax,ymin,ymax,dx,dy,xyc,arat,dfun,\n  \
black,red,green,blue,yellow,white,fill,grey,nofill,f,pbars={},p={}},\n  \
x=y=Table[0,{numnod}]; nf=Length[box]; \n  If [nf>0, xbox=ybox=Table[0,{nf}]; \
\n      For [n=1,n<=nf,n++, {xbox[[n]],ybox[[n]]}=box[[n]] ];\n      \
{xmin,xmax,ymin,ymax}=N[{Min[xbox],Max[xbox],Min[ybox],Max[ybox]}] ];      \n \
 If [nf==0,\n      For [n=1,n<=numnod,n++, {x[[n]],y[[n]]}=nodxyz[[n]] ];\n   \
   {xmin,xmax,ymin,ymax}=N[{Min[x],Max[x],Min[y],Max[y]}] ];\n  \
{dx,dy}={xmax-xmin,ymax-ymin};\n  \
{black,red,green,blue,yellow,white}={RGBColor[0,0,0],RGBColor[1,0,0],\n     \
RGBColor[0,1,0],RGBColor[0,0,1],RGBColor[1,1,0],RGBColor[1,1,1]};\n  \
{nofill,grey,fill}={GrayLevel[0],GrayLevel[.8],GrayLevel[1]};\n  \
arat=AspectRatio->Automatic; \n  If [aspect>0, arat=AspectRatio->aspect];\n  \
If [aspect==0&&dx>0, arat=AspectRatio->dy/dx];\n  \
AppendTo[p,Graphics[AbsoluteThickness[.5]]]; AppendTo[p,Graphics[nofill]];\n  \
enclosingbox={{xmin,ymin},{xmax,ymin},{xmax,ymax},{xmin,ymax},{xmin,ymin}};\n \
 AppendTo[p,Graphics[Line[enclosingbox]]]; \n  \
AppendTo[p,Graphics[AbsoluteThickness[3]]];\n  If \
[Length[amplif]==0,a={amplif},a=amplif];\n  If \
[Length[colors]==0,c={colors},c=colors]; k=Length[c];\n  \
AppendTo[p,Graphics[black]];\n  For [m=1,m<=Length[a],m++, f=a[[m]]; \
color=c[[Min[m,k]]];\n       If [color==\"black\",  \
AppendTo[p,Graphics[black]]];\n       If [color==\"red\",    \
AppendTo[p,Graphics[red]]];\n       If [color==\"blue\",   \
AppendTo[p,Graphics[blue]]];\n       If [color==\"green\",  \
AppendTo[p,Graphics[green]]];\n       If [color==\"yellow\", \
AppendTo[p,Graphics[yellow]]];\n       If [color==\"white\",  \
AppendTo[p,Graphics[white]]];\n       For [n=1,n<=numnod,n++, \n           \
{x[[n]],y[[n]]}=nodxyz[[n]]+f*noddis[[n]]];\n       For [e=1,e<=numele,e++, \
{ni,nj}=elenod[[e]]; \n            xyc={{x[[ni]],y[[ni]]},{x[[nj]],y[[nj]]}}; \
     \n       AppendTo[p,Graphics[Line[xyc] ]]];\n      ];\n dfun=If \
[$VersionNumber>=6.0, Print, $DisplayFunction];\n Show[p, arat, \
ImageSize->imgsiz,PlotLabel->title,DisplayFunction->dfun]; \n \
ClearAll[x,y,xbox,ybox,p]; \n ];\n",
 StyleBox[" \n(* nodxyz={{0,0},{10,5},{10,0},{20,8},{20,0},{30,9},\n       \
{30,0},{40,8},{40,0},{50,5},{50,0},{60,0}};\n\
noddis={{0,0},{0,-10},{0,-10},{0,-15},{0,-15},{0,-20},\n       \
{0,-20},{0,-15},{0,-15},{0,-10},{0,-10},{0,0}}/20;\nnodxyz=N[nodxyz];\n\
elenod={{1,3},{3,5},{5,7},{7,9},{9,11},{11,12},\n        \
{1,2},{2,4},{4,6},{6,8},{8,10},{10,12},\n        \
{2,3},{4,5},{6,7},{8,9},{10,11},\n        {2,5},{4,7},{7,8},{9,10}};\n\
box={{0,-8},{60,-8},{60,10},{0,10}};\n\
PlotPlaneTrussDeformedShape[nodxyz,elenod,noddis,{0,1,2},\n         \
box,\"original & two deformed \
shapes\",{-1,350,{\"red\",\"blue\",\"green\"}}]; \n\
PlotPlaneTrussDeformedShape[nodxyz,elenod,noddis,2.5,box,\n         \
\"deformed shape @ mag 2.5\",{-1,350,\"black\"}]; \n\
PlotPlaneTrussDeformedShape[nodxyz,elenod,noddis,4.0,box,\n         \
\"deformed shape @ mag 4\",{-1,350,\"black\"}]; *)",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[680]:=",ExpressionUUID->"7e54e232-5cca-4583-8b1c-3084a6b83663"],

Cell[TextData[{
 StyleBox["Cell 9.",
  FontWeight->"Bold"],
 " Plot plane truss member stresses"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"f68777bd-3e7a-4ee1-9578-33df1e6ee3c0"],

Cell[TextData[{
 "PlotPlaneTrussStresses[nodxyz_,elenod_,elesig_,sigfac_,box_,\n      \
title_,{aspect_,imgsiz_,labels_}]:=  Module[\n \
{numele=Length[elenod],numnod=Length[nodxyz],\n  \
e,n,ni,nj,nc,nf,xyc,x,y,xbox,ybox,xmin,xmax,ymin,ymax,dx,dy,\n  \
smin,smax,fmax,sval,c1,c2,c3,arat,dfun,pbox={},pbars={}},\n  \
x=y=Table[0,{numnod}]; nf=Length[box];\n  For [n=1,n<=numnod,n++, \
{x[[n]],y[[n]]}=nodxyz[[n]] ];\n  If [nf>0, xbox=ybox=Table[0,{nf}]; \n      \
For [n=1,n<=nf,n++, {xbox[[n]],ybox[[n]]}=box[[n]] ];\n      \
{xmin,xmax,ymin,ymax}=N[{Min[xbox],Max[xbox],Min[ybox],Max[ybox]}] ];      \n \
 If [nf==0,\n      {xmin,xmax,ymin,ymax}=N[{Min[x],Max[x],Min[y],Max[y]}] ];\n\
  {dx,dy}={xmax-xmin,ymax-ymin};\n  \
AppendTo[pbox,Graphics[AbsoluteThickness[.5]]]; \n  \
AppendTo[pbox,Graphics[GrayLevel[0]]];\n  \
enclosingbox={{xmin,ymin},{xmax,ymin},{xmax,ymax},{xmin,ymax},{xmin,ymin}};\n \
 AppendTo[pbox,Graphics[Line[enclosingbox]]];\n  \
AppendTo[pbox,Graphics[AbsoluteThickness[4]]]; \n  smin=Min[elesig]; \
smax=Max[elesig]; fmax=Max[Abs[smax],Abs[smin]];\n  For [e=1,e<=numele,e++, \n\
     sval=N[elesig[[e]]*sigfac]; {c1,c2,c3}=LineColor[sval,fmax];",
 StyleBox[" ",
  FontColor->RGBColor[1, 0, 0]],
 "\n     {ni,nj}=elenod[[e]]; xyc={{x[[ni]],y[[ni]]},{x[[nj]],y[[nj]]}};    \n\
     AppendTo[pbars,Graphics[RGBColor[c1,c2,c3]]];\n     \
AppendTo[pbars,Graphics[Line[xyc]]]\n     ];\n  arat=AspectRatio->Automatic; \
\n  If [aspect>0, arat=AspectRatio->aspect];\n  If [aspect==0&&dx>0, \
arat=AspectRatio->dy/dx];\n  dfun=If [$VersionNumber>=6.0, Print, \
$DisplayFunction];\n  Show[pbox,Graphics[RGBColor[0,0,0]],pbars, \n       \
Background->GrayLevel[0], arat, ImageSize->imgsiz,\n       PlotLabel->title, \
DisplayFunction->dfun];\n   ClearAll[pbars,x,y];\n ];\n\n\
LineColor[f_,fmax_]:= Module[{r,RGBmax={1,0,0},  \n   RGBmin={0,0,1}, \
RGBzero={1,1,1}, RGBout={0,0,0}},\n   If [f==0 || fmax==0,   \n       \
Return[RGBzero]];  (* White if f=0 *)\n   If [f>fmax || f<-fmax, \n       \
Return[RGBout ]];  (* Black if outside range *)\n   If [f>0, r= N[f/fmax]; \n \
      Return[r*RGBmax+(1-r)*RGBzero]]; (* positive *)\n   If [f<0, \
r=-N[f/fmax]; \n       Return[r*RGBmin+(1-r)*RGBzero]]; (* negative *)\n];\n\
",
 StyleBox["\n",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["(* nodxyz={{0,0},{10,5},{10,0},{20,8},{20,0},{30,9},\n       \
{30,0},{40,8},{40,0},{50,5},{50,0},{60,0}};\nelenod= \
{{1,3},{3,5},{5,7},{7,9},{9,11},{11,12},\n         \
{1,2},{2,4},{4,6},{6,8},{8,10},{10,12},\n         \
{2,3},{4,5},{6,7},{8,9},{10,11},\n         {2,5},{4,7},{7,8},{9,10}};\n\
elesig={20,20,20,20,20,20,-10,-10,-10,-10,-10,-10,\n        \
15,12,10,12,15,10,18,18,10};\nbox={{0,-4},{60,-4},{60,10},{0,10}};\n\
PlotPlaneTrussStresses[nodxyz,elenod,elesig,1,box,\n   \"axial stress in \
truss members\",{0,350,labels}]; *)",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 InitializationCell->True,
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[683]:=",ExpressionUUID->"c82b496a-242a-450d-be9b-ecbf9d6267ed"],

Cell[TextData[{
 StyleBox["Cell 10",
  FontWeight->"Bold"],
 ": Driver script to analyze example truss numerically."
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"c51f8354-cdf2-4cd7-bd8e-bfa614559c4f"],

Cell[CellGroupData[{

Cell["\<\
ClearAll[a,Em,A1,A2,A3,fx2,fx3,fy3]; 
a=10; Em=100; A1=1; A2=1/2; A3=2*Sqrt[2]; fx2=0; fx3=2; fy3=1;
nodxyz={{0,0},{a,0},{a,a}}; elenod={{1,2},{2,3},{1,3}};
elemat={Em,Em,Em}; elefab=N[{A1,A2,A3}];
nodtag={{1,1},{0,1},{0,0}}; nodval={{0,0},{fx2,0},{fx3,fy3}};
PrintPlaneTrussNodeCoordinates[nodxyz,\"Node coords of example truss:\",{6,4}];
PrintPlaneTrussElementData[elenod,elemat,elefab,\"Element data of example \
truss:\",{7,4}];
PrintPlaneTrussFreedomActivity[nodtag,nodval,\"DOF activity of example truss:\
\",{}];
aspect=1.0; imgsiz=250; \
box={{0-d,0-d},{10+d,0-d},{10+d,10+d},{0-d,10+d}}/.d->.5; 
labels={{True,0.02,-1.5,1.5},{True,0.04},{\"Times\",12,\"Plain\",\"Italic\"}};\

PlotPlaneTrussElementsAndNodes[nodxyz,elenod,\"Example truss elems & \
nodes:\",
 {aspect,imgsiz,labels}];
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];
f=AppliedForceVector[nodtag,nodval];
Kmod=ModifiedMasterStiffness[nodtag,K];
Print[\"K=\",K//MatrixForm,\" Kmod=\",Kmod//MatrixForm];
fmod=ModifiedNodeForces[nodtag,nodval,K,f];
Print[\"f=\",f//MatrixForm,\" fmod=\",fmod//MatrixForm];
u=Simplify[LinearSolve[Kmod,fmod]]; u=Chop[u]; noddis=Partition[u,2];
PrintPlaneTrussNodeDisplacements[noddis,\"Example truss node \
displacements:\",{10,6}];
box={{0-d,0-d},{10+d,0-d},{10+d,10+d},{0-d,10+d}}/.d->1; 
PlotPlaneTrussDeformedShape[nodxyz,elenod,noddis,{0,1,2},box,\"Example \
truss\"<>
  \" orig & 2 deformed shapes\",{aspect,imgsiz,{\"red\",\"blue\",\"green\"}}]; 
f=Simplify[K.u]; nodfor=Partition[f,2];
PrintPlaneTrussNodeForces[nodfor,\"Example truss node forces w/ \
reactions:\",{10,6}];
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];
elesig=PlaneTrussStresses[elefab,elefor]; \
{elefor,elesig}=Chop[{elefor,elesig}];
PrintPlaneTrussElemForcesAndStresses[elefor,elesig,\"Example truss elem\"<>
       \" forces & stresses:\",{7,4}];
box={{0-d,0-d},{10+d,0-d},{10+d,10+d},{0-d,10+d}}/.d->.5; 
PlotPlaneTrussStresses[nodxyz,elenod,elesig,1,box,
     \"Example truss elem stresses\",{aspect,imgsiz,labels}];\
\>", "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[688]:=",ExpressionUUID->"0e193273-b65a-4871-986a-94f2e33c44e4"],

Cell[BoxData["\<\"Node coords of example truss:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.7457612426386633`*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"a1f68bb3-ac5b-4a99-b30b-c05e3c7ead2a"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-coor\"\>",
       HoldForm], 
      TagBox["\<\"y-coor\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"     10\"\>",
        10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"     10\"\>",
        10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"     10\"\>",
        10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[1.4]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 2}, 
    TableHeadings -> {None, {"node", "x-coor", "y-coor"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242640472*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"d49fed11-dce8-415b-aef3-39bb03422b5e"],

Cell[BoxData["\<\"Element data of example truss:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.74576124264202*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"f3b66222-c029-47a1-908c-65e91da35635"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"elem\"\>",
       HoldForm], 
      TagBox["\<\"nodes\"\>",
       HoldForm], 
      TagBox["\<\"modulus\"\>",
       HoldForm], 
      TagBox["\<\"area\"\>",
       HoldForm]},
     {"\<\"1\"\>", "\<\"{1, 2}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   1.0000\"\>",
        1.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"2\"\>", "\<\"{2, 3}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   0.5000\"\>",
        0.5,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"3\"\>", "\<\"{1, 3}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   2.8284\"\>",
        2.8284271247461903`,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[1.4]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 2}, 
    TableHeadings -> {None, {"elem", "nodes", "modulus", "area"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.74576124264354*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"0b959b29-1cee-40ce-aa4b-ec544e802fc5"],

Cell[BoxData["\<\"DOF activity of example truss:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242645646*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"fb4b8be4-5fed-4b02-9b63-743fc04b0c9c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-tag\"\>",
       HoldForm], 
      TagBox["\<\"y-tag\"\>",
       HoldForm], 
      TagBox["\<\"x-value\"\>",
       HoldForm], 
      TagBox["\<\"y-value\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 2\"\>",
        2,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {
     None, {"node", "x-tag", "y-tag", "x-value", "y-value"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242647108*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"da520e1f-c928-40aa-8542-2b813f159eaf"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[1, 0, 0], AbsoluteThickness[3], LineBox[{{0, 0}, {10, 0}}], 
    LineBox[{{10, 0}, {10, 10}}], LineBox[{{0, 0}, {10, 10}}]}, 
   {GrayLevel[1], AbsoluteThickness[1], DiskBox[{0, 0}, 0.2], 
    DiskBox[{10, 0}, 0.2], DiskBox[{10, 10}, 0.2], 
    {GrayLevel[0], CircleBox[{0, 0}, 0.2], CircleBox[{10, 0}, 0.2], 
     CircleBox[{10, 10}, 0.2]}, 
    {RGBColor[1, 1, 0], DiskBox[{5, 0}, 0.4], DiskBox[{10, 5}, 0.4], 
     DiskBox[{5, 5}, 0.4]}, 
    {RGBColor[0, 0, 0], CircleBox[{5, 0}, 0.4], CircleBox[{10, 5}, 0.4], 
     CircleBox[{5, 5}, 0.4], InsetBox["\<\"1\"\>", {5, -0.08000000000000002},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"2\"\>", {10, 4.92},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"3\"\>", {5, 4.92},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], 
     InsetBox["\<\"1\"\>", {-0.30000000000000004, 0.30000000000000004},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}], InsetBox["\<\"2\"\>", {9.7, 0.30000000000000004},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}], InsetBox["\<\"3\"\>", {9.7, 10.3},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}]}}},
  AspectRatio->1.,
  DisplayFunction->Print,
  ImageSize->250,
  PlotLabel->FormBox[
   "\"Example truss elems & nodes:\"", TraditionalForm]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.7457612426495953`*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"f2dfdfa3-583e-4423-8171-ad9628dc66e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"K=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"20.`", "10.`", 
        RowBox[{"-", "10.`"}], "0.`", 
        RowBox[{"-", "10.`"}], 
        RowBox[{"-", "10.`"}]},
       {"10.`", "10.`", "0.`", "0.`", 
        RowBox[{"-", "10.`"}], 
        RowBox[{"-", "10.`"}]},
       {
        RowBox[{"-", "10.`"}], "0.`", "10.`", "0.`", "0.`", "0.`"},
       {"0.`", "0.`", "0.`", "5.`", "0.`", 
        RowBox[{"-", "5.`"}]},
       {
        RowBox[{"-", "10.`"}], 
        RowBox[{"-", "10.`"}], "0.`", "0.`", "10.`", "10.`"},
       {
        RowBox[{"-", "10.`"}], 
        RowBox[{"-", "10.`"}], "0.`", 
        RowBox[{"-", "5.`"}], "10.`", "15.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Kmod=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0"},
       {"0", "0", "10.`", "0", "0.`", "0.`"},
       {"0", "0", "0", "1", "0", "0"},
       {"0", "0", "0.`", "0", "10.`", "10.`"},
       {"0", "0", "0.`", "0", "10.`", "15.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["K=", 
   MatrixForm[{{20., 10., -10., 0., -10., -10.}, {10., 10., 0., 
    0., -10., -10.}, {-10., 0., 10., 0., 0., 0.}, {0., 0., 0., 5., 
    0., -5.}, {-10., -10., 0., 0., 10., 10.}, {-10., -10., 0., -5., 10., 
    15.}}], " Kmod=", 
   MatrixForm[{{1, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0}, {
     0, 0, 10., 0, 0., 0.}, {0, 0, 0, 1, 0, 0}, {0, 0, 0., 0, 10., 10.}, {
     0, 0, 0., 0, 10., 15.}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242652886*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"a22f60da-ff62-4ec0-990b-0488abd435c3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"2"},
        {"1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" fmod=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"2"},
        {"1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["f=", 
   MatrixForm[{0, 0, 0, 0, 2, 1}], " fmod=", 
   MatrixForm[{0, 0, 0, 0, 2, 1}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242654189*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"9ab76ad3-80a8-46a6-a760-6f35d22d4978"],

Cell[BoxData["\<\"Example truss node displacements:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.7457612426550007`*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"26c672e3-2813-4dd7-b6d0-80e707e5633c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-displ\"\>",
       HoldForm], 
      TagBox["\<\"y-displ\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.400000\"\>",
        0.4,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"   -0.200000\"\>",
        -0.2,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {None, {"node", "x-displ", "y-displ"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.7457612426559067`*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"583b9e5a-a0b6-4507-a08a-c369e4085171"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], AbsoluteThickness[0.5], 
    LineBox[{{-1., -1.}, {11., -1.}, {11., 11.}, {-1., 11.}, {-1., -1.}}]}, 
   {RGBColor[1, 0, 0], AbsoluteThickness[3], LineBox[{{0, 0}, {10, 0}}], 
    LineBox[{{10, 0}, {10., 10.}}], LineBox[{{0, 0}, {10., 10.}}], 
    {RGBColor[0, 0, 1], LineBox[{{0, 0}, {10, 0}}], 
     LineBox[{{10, 0}, {10.4, 9.8}}], LineBox[{{0, 0}, {10.4, 9.8}}]}, 
    {RGBColor[0, 1, 0], LineBox[{{0, 0}, {10, 0}}], 
     LineBox[{{10, 0}, {10.8, 9.6}}], LineBox[{{0, 0}, {10.8, 9.6}}]}}},
  AspectRatio->1.,
  DisplayFunction->Print,
  ImageSize->250,
  PlotLabel->FormBox[
   "\"Example truss orig & 2 deformed shapes\"", TraditionalForm]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242657114*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"470495ce-9edb-4a3b-aacb-0996c74ac242"],

Cell[BoxData["\<\"Example truss node forces w/ reactions:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242658293*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"e5197121-08b7-4e71-b693-7960b1a708ff"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-force\"\>",
       HoldForm], 
      TagBox["\<\"y-force\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"   -2.000000\"\>",
        -2.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"   -2.000000\"\>",
        -2.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.000000\"\>",
        0.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"    1.000000\"\>",
        1.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"    2.000000\"\>",
        2.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"    1.000000\"\>",
        1.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {None, {"node", "x-force", "y-force"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242659245*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"adad71d5-96cd-4dbc-91a8-416b799e8478"],

Cell[BoxData["\<\"Example truss elem forces & stresses:\"\>"], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242660247*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"19684a13-005a-49e1-957f-5d5daa2fd4e0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"elem\"\>",
       HoldForm], 
      TagBox["\<\"axial force\"\>",
       HoldForm], 
      TagBox["\<\"axial stress\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"       0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"       0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"  -1.0000\"\>",
        -1.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"  -2.0000\"\>",
        -2.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"   2.8284\"\>",
        2.8284271247461903`,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   1.0000\"\>",
        1.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {
     None, {"elem", "axial force", "axial stress"}}]]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.745761242661154*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"f998d12c-e433-4dec-b4ad-51d6bd7de4ce"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], AbsoluteThickness[0.5], 
    LineBox[{{-0.5, -0.5}, {10.5, -0.5}, {10.5, 10.5}, {-0.5, 
     10.5}, {-0.5, -0.5}}]}, 
   {RGBColor[1, 1, 1], AbsoluteThickness[4], LineBox[{{0, 0}, {10, 0}}], 
    {RGBColor[0., 0., 1.], LineBox[{{10, 0}, {10, 10}}]}, 
    {RGBColor[1., 0.5, 0.5], LineBox[{{0, 0}, {10, 10}}]}}},
  AspectRatio->1.,
  Background->GrayLevel[0],
  DisplayFunction->Print,
  ImageSize->250,
  PlotLabel->FormBox[
   "\"Example truss elem stresses\"", TraditionalForm]]], "Print",
 CellChangeTimes->{3.745757590753117*^9, 3.7457612426623077`*^9},
 CellLabel->
  "During evaluation of \
In[688]:=",ExpressionUUID->"bbe041a7-5f3e-47a5-91c6-d3ff178d524a"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 11. ",
  FontWeight->"Bold"],
 " Script for analysis of example truss, leaving forces at nodes 2 and  3 \
symbolic. ",
 StyleBox["Do not use print or plot utilities",
  FontWeight->"Bold"]
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"5799532a-b638-425a-90bd-ad1165584781"],

Cell[CellGroupData[{

Cell["\<\
ClearAll[fx2,fx3,fy3];
nodxyz={{0,0},{10,0},{10,10}}; elenod={{1,2},{2,3},{1,3}};
elemat={100,100,100}; elefab={1,1/2,2*Sqrt[2]}; 
nodtag={{1,1},{0,1},{0,0}}; nodval={{0,0},{fx2,0},{fx3,fy3}};
Print[\"Node coord of example truss:\",nodxyz];
Print[\"Element data of example truss:\",{elenod,elemat,elefab}];
Print[\"DOF activity of example truss:\",{nodtag,nodval}];
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];
f=AppliedForceVector[nodtag,nodval];
Kmod=ModifiedMasterStiffness[nodtag,K];
fmod=ModifiedNodeForces[nodtag,nodval,K,f];
u=Simplify[LinearSolve[Kmod,fmod]]; noddis=Partition[u,2]; 
Print[\"Computed node displacements:\",u];
f=Simplify[K.u]; nodfor=Partition[f,2];
Print[\"Node forces including reactions:\",f];
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];
elesig=PlaneTrussStresses[elefab,elefor];
Print[\"Elem forces: \",elefor]; Print[\"Elem stresses: \",elesig];\
\>", "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[716]:=",ExpressionUUID->"7d5b8866-78c1-493a-b18e-c3dc2d0f05cd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node coord of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}]}], "}"}]}],
  SequenceForm["Node coord of example truss:", {{0, 0}, {10, 0}, {10, 10}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242683935*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"c6200c31-cff7-414e-bd42-84b348366c66"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Element data of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100", ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "2"], ",", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "Element data of example truss:", {{{1, 2}, {2, 3}, {1, 3}}, {100, 100, 
    100}, {1, 
     Rational[1, 2], 2 2^Rational[1, 2]}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242685155*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"dc632913-548b-4271-b9ff-0b2a872fbe0e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"DOF activity of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fx2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fx3", ",", "fy3"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "DOF activity of example truss:", {{{1, 1}, {0, 1}, {0, 
    0}}, {{0, 
     0}, {$CellContext`fx2, 0}, {$CellContext`fx3, $CellContext`fy3}}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242686055*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"5278dfba-4074-4caa-8830-3a9f90b1e70f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computed node displacements:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["fx2", "10"], ",", "0", ",", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "fx3"}], "-", 
        RowBox[{"2", " ", "fy3"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "fx3"}], "+", "fy3"}], ")"}]}]}], "}"}]}],
  SequenceForm[
  "Computed node displacements:", {
   0, 0, Rational[1, 10] $CellContext`fx2, 0, 
    Rational[1, 10] (3 $CellContext`fx3 - 2 $CellContext`fy3), 
    Rational[1, 5] (-$CellContext`fx3 + $CellContext`fy3)}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242686893*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"d79c1342-fd5f-4022-b5ec-bfade9dfb9b8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node forces including reactions:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "fx2"}], "-", "fx3"}], ",", 
     RowBox[{"-", "fx3"}], ",", "fx2", ",", 
     RowBox[{"fx3", "-", "fy3"}], ",", "fx3", ",", "fy3"}], "}"}]}],
  SequenceForm[
  "Node forces including reactions:", {-$CellContext`fx2 - $CellContext`fx3, \
-$CellContext`fx3, $CellContext`fx2, $CellContext`fx3 - $CellContext`fy3, \
$CellContext`fx3, $CellContext`fy3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242687729*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"d1f72fc6-6a6f-45ce-bede-fa065642f480"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem forces: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"fx2", ",", 
     RowBox[{
      RowBox[{"-", "fx3"}], "+", "fy3"}], ",", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "fx3"}], "-", 
        RowBox[{"2", " ", "fy3"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "fx3"}], "+", "fy3"}], ")"}]}]}], ")"}]}]}], "}"}]}],
  SequenceForm[
  "Elem forces: ", {$CellContext`fx2, -$CellContext`fx3 + $CellContext`fy3, 
    2^Rational[1, 2] (3 $CellContext`fx3 - 2 $CellContext`fy3 + 
     2 (-$CellContext`fx3 + $CellContext`fy3))}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242688509*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"c65cd925-7a2f-4819-a99e-132f079057d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem stresses: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"fx2", ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "fx3"}], "+", "fy3"}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "fx3"}], "-", 
        RowBox[{"2", " ", "fy3"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "fx3"}], "+", "fy3"}], ")"}]}]}], ")"}]}]}], "}"}]}],
  SequenceForm[
  "Elem stresses: ", {$CellContext`fx2, 
    2 (-$CellContext`fx3 + $CellContext`fy3), 
    Rational[1, 2] (3 $CellContext`fx3 - 2 $CellContext`fy3 + 
     2 (-$CellContext`fx3 + $CellContext`fy3))}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757597877487*^9, 3.745761242689344*^9},
 CellLabel->
  "During evaluation of \
In[716]:=",ExpressionUUID->"0f66d559-3145-46d2-89e3-856e7765f387"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 12.",
  FontWeight->"Bold"],
 "  Example truss with symbolic coordinates, areas and forces. ",
 StyleBox["Do not use print or plot utilities",
  FontWeight->"Bold"]
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"e45cb9bf-ed0e-4357-b6a7-ba21dd021a64"],

Cell[CellGroupData[{

Cell["\<\
ClearAll[fx2,fx3,fy3,a,b,A1,A2,A3,Em];
nodxyz={{0,0},{a,0},{a,b}}; elenod={{1,2},{2,3},{1,3}};
elemat={Em,Em,Em}; elefab={A1,A2,A3}; 
nodtag={{1,1},{0,1},{0,0}}; nodval={{0,0},{fx2,0},{fx3,fy3}};
Print[\"Node coord of example truss:\",nodxyz];
Print[\"Element data of example truss:\",{elenod,elemat,elefab}];
Print[\"DOF activity of example truss:\",{nodtag,nodval}];
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];
K=Simplify[K,a>0&&b>0];
f=AppliedForceVector[nodtag,nodval];
Kmod=ModifiedMasterStiffness[nodtag,K];
fmod=ModifiedNodeForces[nodtag,nodval,K,f];
u=Simplify[LinearSolve[Kmod,fmod],a>0&&b>0]; noddis=Partition[u,2]; 
Print[\"Computed node displacements:\",u];
f=Simplify[K.u,a>0&&b>0]; nodfor=Partition[f,2];
Print[\"Node forces including reactions:\",f];
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];
elefor=Simplify[elefor,a>0&&b>0];
elesig=PlaneTrussStresses[elefab,elefor]; 
elesig=Simplify[elesig,a>0&&b>0];
Print[\"Elem forces: \",elefor]; Print[\"Elem stresses: \",elesig];\
\>", "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 1}},
 Background->RGBColor[0, 1, 0],
 CellLabel->
  "In[734]:=",ExpressionUUID->"ba3c56a6-a56d-4b8f-bf9a-a7bceb772eab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node coord of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}],
  SequenceForm[
  "Node coord of example truss:", {{0, 
    0}, {$CellContext`a, 0}, {$CellContext`a, $CellContext`b}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.7457612427064037`*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"066b9243-f1ca-43e8-8f91-e4a2d376e665"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Element data of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Em", ",", "Em", ",", "Em"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"A1", ",", "A2", ",", "A3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "Element data of example truss:", {{{1, 2}, {2, 3}, {1, 
    3}}, {$CellContext`Em, $CellContext`Em, $CellContext`Em}, \
{$CellContext`A1, $CellContext`A2, $CellContext`A3}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.7457612427076674`*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"22930350-a6a7-4c0e-8def-db1c2d09963c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"DOF activity of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fx2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fx3", ",", "fy3"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "DOF activity of example truss:", {{{1, 1}, {0, 1}, {0, 
    0}}, {{0, 
     0}, {$CellContext`fx2, 0}, {$CellContext`fx3, $CellContext`fy3}}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.745761242708589*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"c917411c-ed53-400e-82b8-d97e91fa3398"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computed node displacements:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{"a", " ", "fx2"}], 
      RowBox[{"A1", " ", "Em"}]], ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"A2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", "fx3"}], "+", 
       RowBox[{"A3", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "fx3"}], "-", 
          RowBox[{"a", " ", "fy3"}]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox["a", "2"], " ", "A2", " ", "A3", " ", "Em"}]], ",", 
     FractionBox[
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "b"}], " ", "fx3"}], "+", 
         RowBox[{"a", " ", "fy3"}]}], ")"}]}], 
      RowBox[{"a", " ", "A2", " ", "Em"}]]}], "}"}]}],
  SequenceForm[
  "Computed node displacements:", {
   0, 0, $CellContext`a $CellContext`A1^(-1) $CellContext`Em^(-1) \
$CellContext`fx2, 
    0, $CellContext`a^(-2) $CellContext`A2^(-1) $CellContext`A3^(-1) \
$CellContext`Em^(-1) ($CellContext`A2 ($CellContext`a^2 + $CellContext`b^2)^
       Rational[
        3, 2] $CellContext`fx3 + $CellContext`A3 $CellContext`b^2 \
($CellContext`b $CellContext`fx3 - $CellContext`a $CellContext`fy3)), \
$CellContext`a^(-1) $CellContext`A2^(-1) $CellContext`b $CellContext`Em^(-1) \
(-$CellContext`b $CellContext`fx3 + $CellContext`a $CellContext`fy3)}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.745761242737323*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"dc1122e8-ccf8-46e8-9a11-31fa21bafe45"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node forces including reactions:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "fx2"}], "-", "fx3"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", "fx3"}], "a"]}], ",", "fx2", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"b", " ", "fx3"}], "a"], "-", "fy3"}], ",", "fx3", ",", 
     "fy3"}], "}"}]}],
  SequenceForm[
  "Node forces including reactions:", {-$CellContext`fx2 - $CellContext`fx3, \
-$CellContext`a^(-1) $CellContext`b $CellContext`fx3, $CellContext`fx2, \
$CellContext`a^(-1) $CellContext`b $CellContext`fx3 - $CellContext`fy3, \
$CellContext`fx3, $CellContext`fy3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.745761242749896*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"e78d667d-302c-41f1-87ea-2f35e01cdcca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem forces: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"fx2", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"b", " ", "fx3"}], "a"]}], "+", "fy3"}], ",", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"]}]], " ", "fx3"}], "a"]}], "}"}]}],
  SequenceForm[
  "Elem forces: ", {$CellContext`fx2, -$CellContext`a^(-1) $CellContext`b \
$CellContext`fx3 + $CellContext`fy3, $CellContext`a^(-1) ($CellContext`a^2 + \
$CellContext`b^2)^Rational[1, 2] $CellContext`fx3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.745761242750944*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"6a7429ec-667b-4823-afd0-5c0affcce52a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem stresses: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["fx2", "A1"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"b", " ", "fx3"}], "a"]}], "+", "fy3"}], "A2"], ",", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"]}]], " ", "fx3"}], 
      RowBox[{"a", " ", "A3"}]]}], "}"}]}],
  SequenceForm[
  "Elem stresses: ", {$CellContext`A1^(-1) $CellContext`fx2, \
$CellContext`A2^(-1) (-$CellContext`a^(-1) $CellContext`b $CellContext`fx3 + \
$CellContext`fy3), $CellContext`a^(-1) $CellContext`A3^(-1) ($CellContext`a^2 + \
$CellContext`b^2)^Rational[1, 2] $CellContext`fx3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.745757603029313*^9, 3.745761242751691*^9},
 CellLabel->
  "During evaluation of \
In[734]:=",ExpressionUUID->"c76ced9d-6864-4646-9c1c-25e38d02ea96"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 13.",
  FontWeight->"Bold"],
 "  Script for Exercise 4.1 - all numerical"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"24a2fe85-647e-463f-a203-47c5e3e0a6b0"],

Cell[CellGroupData[{

Cell["\<\
ClearAll[a,Em,A1,A2,A3,fx2,fx3,fy3];
a=10; b=10; Em=100; A1=2; A2=2; A3=4; A4=4; A5=4; fy2=-15; fx3=0; fx2=0; \
fx4=0; fy4=0;
nodxyz={{-a,0},{0,0},{a,0},{0,b}}; elenod={{1,2},{2,3},{1,4},{3,4},{2,4}};
elemat={Em,Em,Em,Em,Em}; elefab=N[{A1,A2,A3,A4,A5}];
nodtag={{1,1},{0,0},{0,1},{0,0}}; nodval={{0,0},{fx2,fy2},{fx3,0},{fx4,fy4}};
PrintPlaneTrussNodeCoordinates[nodxyz,\"Node coords of truss:\",{6,4}];
PrintPlaneTrussElementData[elenod,elemat,elefab,\"Element data of \
truss:\",{7,4}];
PrintPlaneTrussFreedomActivity[nodtag,nodval,\"DOF activity of truss:\",{}];
aspect=.5; imgsiz=300; box={{-a-d,0-d},{0+d,0-d},{a+d,0-d},{0-d,b+d}}/.d->.5; \

labels={{True,0.03,-1.8,1.8},{True,0.06},{\"Times\",12,\"Plain\",\"Italic\"}};\

PlotPlaneTrussElementsAndNodes[nodxyz,elenod,\"Truss elems & nodes:\",
 {aspect,imgsiz,labels}];
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];
f=AppliedForceVector[nodtag,nodval];
Kmod=ModifiedMasterStiffness[nodtag,K];
Print[\"K=\",K//MatrixForm,\" Kmod=\",Kmod//MatrixForm];
fmod=ModifiedNodeForces[nodtag,nodval,K,f];
Print[\"f=\",f//MatrixForm,\" fmod=\",fmod//MatrixForm];
u=Simplify[LinearSolve[Kmod,fmod]]; u=Chop[u]; noddis=Partition[u,2];
PrintPlaneTrussNodeDisplacements[noddis,\"Truss node \
displacements:\",{10,6}];
box={{-a-d,0-2*d},{0+d,0-2*d},{a+2*d,0-2*d},{0-d,b+2*d}}/.d->1.5; 
PlotPlaneTrussDeformedShape[nodxyz,elenod,noddis,{0,1,2},box,\"Truss\"<>
  \" orig & 2 deformed \
shapes\",{aspect,imgsiz,{\"red\",\"blue\",\"green\"}}];
f=Simplify[K.u]; nodfor=Partition[f,2];
PrintPlaneTrussNodeForces[nodfor,\"Example truss node forces w/ \
reactions:\",{10,6}];
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];
elesig=PlaneTrussStresses[elefab,elefor]; \
{elefor,elesig}=Chop[{elefor,elesig}];
PrintPlaneTrussElemForcesAndStresses[elefor,elesig,\"Truss elem\"<>
       \" forces & stresses:\",{7,4}];
box={{-a-d,0-d},{0+d,0-d},{a+d,0-d},{0-d,b+d}}/.d->1; 
PlotPlaneTrussStresses[nodxyz,elenod,elesig,1,box,
     \"Example truss elem stresses\",{aspect,imgsiz,labels}];\
\>", "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.745757917493548*^9, 3.745757966076557*^9}, {
   3.745758110570218*^9, 3.745758128157302*^9}, {3.7457581698057137`*^9, 
   3.745758171670451*^9}, {3.745758205360073*^9, 3.745758404277763*^9}, {
   3.745758679745221*^9, 3.7457586818354816`*^9}, {3.745758712036757*^9, 
   3.745758740186317*^9}, {3.74575877318829*^9, 3.745758818835559*^9}, {
   3.745758895018198*^9, 3.745759008928418*^9}, {3.745759096930726*^9, 
   3.745759101217867*^9}, {3.745759212668831*^9, 3.745759243799453*^9}, {
   3.745759278549206*^9, 3.745759279120206*^9}, {3.745759321714122*^9, 
   3.745759350882934*^9}, {3.7457594205194607`*^9, 3.745759421018951*^9}, {
   3.745759497196678*^9, 3.745759527519764*^9}, {3.745759575859964*^9, 
   3.745759624907378*^9}, {3.745759660326795*^9, 3.745759663228609*^9}, {
   3.745759704492454*^9, 3.7457597165924377`*^9}, {3.745759807424652*^9, 
   3.7457598078862123`*^9}, {3.7457598443636923`*^9, 3.745759848137982*^9}, {
   3.745759896427483*^9, 3.745759916297896*^9}, 3.745759987611754*^9, {
   3.7457600193573008`*^9, 3.745760023621524*^9}, {3.745760121973879*^9, 
   3.7457601234871187`*^9}, {3.745760299939247*^9, 3.7457603046586647`*^9}, {
   3.745760344521325*^9, 3.745760399880744*^9}, {3.7457605919689093`*^9, 
   3.7457605949631042`*^9}, 3.745760641054658*^9, {3.745760673744371*^9, 
   3.7457606929036922`*^9}, 3.745760752265953*^9, {3.745760804551296*^9, 
   3.745760818027191*^9}, 3.745760852509137*^9, {3.745760904008389*^9, 
   3.745761055406969*^9}, {3.745761139691016*^9, 3.7457611695507107`*^9}, {
   3.745762176473033*^9, 3.7457621862423*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[974]:=",ExpressionUUID->"6350a9ee-727b-4e9e-a063-b7fc095ffa3d"],

Cell[BoxData["\<\"Node coords of truss:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203761817*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"60dbcd5a-032e-411e-aa99-a7342a350c58"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-coor\"\>",
       HoldForm], 
      TagBox["\<\"y-coor\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"    -10\"\>",
        -10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"     10\"\>",
        10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]},
     {"\<\"4\"\>", 
      TagBox[
       InterpretationBox["\<\"      0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {6, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"     10\"\>",
        10,
        Editable->False],
       PaddedForm[#, {6, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[1.4]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 2}, 
    TableHeadings -> {None, {"node", "x-coor", "y-coor"}}]]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203764587*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"99712cca-d378-4937-a8d7-0204e09cd312"],

Cell[BoxData["\<\"Element data of truss:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.74576220376643*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"7a009546-afc9-42a9-964d-4d775e25f3cd"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"elem\"\>",
       HoldForm], 
      TagBox["\<\"nodes\"\>",
       HoldForm], 
      TagBox["\<\"modulus\"\>",
       HoldForm], 
      TagBox["\<\"area\"\>",
       HoldForm]},
     {"\<\"1\"\>", "\<\"{1, 2}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   2.0000\"\>",
        2.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"2\"\>", "\<\"{2, 3}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   2.0000\"\>",
        2.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"3\"\>", "\<\"{1, 4}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   4.0000\"\>",
        4.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"4\"\>", "\<\"{3, 4}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   4.0000\"\>",
        4.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"5\"\>", "\<\"{2, 4}\"\>", 
      TagBox[
       InterpretationBox["\<\"     100\"\>",
        100,
        Editable->False],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   4.0000\"\>",
        4.,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[1.4]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 2}, 
    TableHeadings -> {None, {"elem", "nodes", "modulus", "area"}}]]]], "Print",\

 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203767735*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"404b2055-2daa-40a9-af29-20bed6a41d95"],

Cell[BoxData["\<\"DOF activity of truss:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.7457622037694387`*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"f65219f5-1422-4865-b106-7b5944b6c520"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-tag\"\>",
       HoldForm], 
      TagBox["\<\"y-tag\"\>",
       HoldForm], 
      TagBox["\<\"x-value\"\>",
       HoldForm], 
      TagBox["\<\"y-value\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\"-15\"\>",
        -15,
        Editable->False],
       PaddedForm]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 1\"\>",
        1,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm]},
     {"\<\"4\"\>", 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm], 
      TagBox[
       InterpretationBox["\<\" 0\"\>",
        0,
        Editable->False],
       PaddedForm]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {
     None, {"node", "x-tag", "y-tag", "x-value", "y-value"}}]]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203770604*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"acdca29e-7d63-48c4-a93e-390cdd7eab4c"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[1, 0, 0], AbsoluteThickness[3], LineBox[{{-10, 0}, {0, 0}}], 
    LineBox[{{0, 0}, {10, 0}}], LineBox[{{-10, 0}, {0, 10}}], 
    LineBox[{{10, 0}, {0, 10}}], LineBox[{{0, 0}, {0, 10}}]}, 
   {GrayLevel[1], AbsoluteThickness[1], DiskBox[{-10, 0}, 0.3], 
    DiskBox[{0, 0}, 0.3], DiskBox[{10, 0}, 0.3], DiskBox[{0, 10}, 0.3], 
    {GrayLevel[0], CircleBox[{-10, 0}, 0.3], CircleBox[{0, 0}, 0.3], 
     CircleBox[{10, 0}, 0.3], CircleBox[{0, 10}, 0.3]}, 
    {RGBColor[1, 1, 0], DiskBox[{-5, 0}, 0.6], DiskBox[{5, 0}, 0.6], 
     DiskBox[{-5, 5}, 0.6], DiskBox[{5, 5}, 0.6], DiskBox[{0, 5}, 0.6]}, 
    {RGBColor[0, 0, 0], CircleBox[{-5, 0}, 0.6], CircleBox[{5, 0}, 0.6], 
     CircleBox[{-5, 5}, 0.6], CircleBox[{5, 5}, 0.6], CircleBox[{0, 5}, 0.6], 
     InsetBox["\<\"1\"\>", {-5, -0.12},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"2\"\>", {5, -0.12},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"3\"\>", {-5, 4.88},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"4\"\>", {5, 4.88},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"5\"\>", {0, 4.88},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Plain", 
        FontSlant -> "Italic"}], InsetBox["\<\"1\"\>", {-10.54, 0.54},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}], InsetBox["\<\"2\"\>", {-0.54, 0.54},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}], InsetBox["\<\"3\"\>", {9.46, 0.54},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}], InsetBox["\<\"4\"\>", {-0.54, 10.54},
      BaseStyle->{
       FontFamily -> "Times", FontSize -> 12, FontWeight -> "Bold", FontSlant -> 
        "Plain"}]}}},
  AspectRatio->0.5,
  DisplayFunction->Print,
  ImageSize->300,
  PlotLabel->FormBox["\"Truss elems & nodes:\"", TraditionalForm]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203772871*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"06596b2a-9277-44c6-bee9-5b5cd0d8dfe3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"K=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"34.14213562373095`", "14.14213562373095`", 
        RowBox[{"-", "20.`"}], "0.`", "0", "0", 
        RowBox[{"-", "14.14213562373095`"}], 
        RowBox[{"-", "14.14213562373095`"}]},
       {"14.14213562373095`", "14.14213562373095`", "0.`", "0.`", "0", "0", 
        RowBox[{"-", "14.14213562373095`"}], 
        RowBox[{"-", "14.14213562373095`"}]},
       {
        RowBox[{"-", "20.`"}], "0.`", "40.`", "0.`", 
        RowBox[{"-", "20.`"}], "0.`", "0.`", "0.`"},
       {"0.`", "0.`", "0.`", "40.`", "0.`", "0.`", "0.`", 
        RowBox[{"-", "40.`"}]},
       {"0", "0", 
        RowBox[{"-", "20.`"}], "0.`", "34.14213562373095`", 
        RowBox[{"-", "14.14213562373095`"}], 
        RowBox[{"-", "14.14213562373095`"}], "14.14213562373095`"},
       {"0", "0", "0.`", "0.`", 
        RowBox[{"-", "14.14213562373095`"}], "14.14213562373095`", 
        "14.14213562373095`", 
        RowBox[{"-", "14.14213562373095`"}]},
       {
        RowBox[{"-", "14.14213562373095`"}], 
        RowBox[{"-", "14.14213562373095`"}], "0.`", "0.`", 
        RowBox[{"-", "14.14213562373095`"}], "14.14213562373095`", 
        "28.2842712474619`", "0.`"},
       {
        RowBox[{"-", "14.14213562373095`"}], 
        RowBox[{"-", "14.14213562373095`"}], "0.`", 
        RowBox[{"-", "40.`"}], "14.14213562373095`", 
        RowBox[{"-", "14.14213562373095`"}], "0.`", "68.2842712474619`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" Kmod=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "40.`", "0.`", 
        RowBox[{"-", "20.`"}], "0", "0.`", "0.`"},
       {"0", "0", "0.`", "40.`", "0.`", "0", "0.`", 
        RowBox[{"-", "40.`"}]},
       {"0", "0", 
        RowBox[{"-", "20.`"}], "0.`", "34.14213562373095`", "0", 
        RowBox[{"-", "14.14213562373095`"}], "14.14213562373095`"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0.`", "0.`", 
        RowBox[{"-", "14.14213562373095`"}], "0", "28.2842712474619`", 
        "0.`"},
       {"0", "0", "0.`", 
        RowBox[{"-", "40.`"}], "14.14213562373095`", "0", "0.`", 
        "68.2842712474619`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["K=", 
   MatrixForm[{{
     34.14213562373095, 14.14213562373095, -20., 0., 0, 
      0, -14.14213562373095, -14.14213562373095}, {
     14.14213562373095, 14.14213562373095, 0., 0., 0, 
      0, -14.14213562373095, -14.14213562373095}, {-20., 0., 40., 0., -20., 
     0., 0., 0.}, {0., 0., 0., 40., 0., 0., 0., -40.}, {
     0, 0, -20., 0., 
      34.14213562373095, -14.14213562373095, -14.14213562373095, 
      14.14213562373095}, {
     0, 0, 0., 0., -14.14213562373095, 14.14213562373095, 
      14.14213562373095, -14.14213562373095}, {-14.14213562373095, \
-14.14213562373095, 0., 0., -14.14213562373095, 14.14213562373095, 
     28.2842712474619, 0.}, {-14.14213562373095, -14.14213562373095, 0., -40.,
      14.14213562373095, -14.14213562373095, 0., 68.2842712474619}}], 
   " Kmod=", 
   MatrixForm[{{1, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0}, {
     0, 0, 40., 0., -20., 0, 0., 0.}, {0, 0, 0., 40., 0., 0, 0., -40.}, {
     0, 0, -20., 0., 34.14213562373095, 0, -14.14213562373095, 
      14.14213562373095}, {0, 0, 0, 0, 0, 1, 0, 0}, {
     0, 0, 0., 0., -14.14213562373095, 0, 28.2842712474619, 0.}, {
     0, 0, 0., -40., 14.14213562373095, 0, 0., 68.2842712474619}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203776486*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"09da85fc-069c-45e3-ac67-3be749f2be9f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {
         RowBox[{"-", "15"}]},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" fmod=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {
         RowBox[{"-", "15"}]},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["f=", 
   MatrixForm[{0, 0, 0, -15, 0, 0, 0, 0}], " fmod=", 
   MatrixForm[{0, 0, 0, -15, 0, 0, 0, 0}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203778349*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"c1bbb92d-de75-48ad-be87-8479c3027158"],

Cell[BoxData["\<\"Truss node displacements:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.7457622037799683`*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"434a71ad-c5d4-4663-ae66-ed19a9011acc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-displ\"\>",
       HoldForm], 
      TagBox["\<\"y-displ\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.375000\"\>",
        0.3749999999999998,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"   -1.280330\"\>",
        -1.2803300858899103`,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.750000\"\>",
        0.7499999999999996,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"          0\"\>",
        0,
        Editable->False],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"4\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.375000\"\>",
        0.3749999999999998,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"   -0.905330\"\>",
        -0.9053300858899104,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {None, {"node", "x-displ", "y-displ"}}]]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.74576220378097*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"6f54324b-b92f-48e0-973a-c34d1baa51db"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], AbsoluteThickness[0.5], 
    LineBox[{{-11.5, -3.}, {13., -3.}, {13., 13.}, {-11.5, 
     13.}, {-11.5, -3.}}]}, 
   {RGBColor[1, 0, 0], AbsoluteThickness[3], LineBox[{{-10, 0}, {0., 0.}}], 
    LineBox[{{0., 0.}, {10., 0}}], LineBox[{{-10, 0}, {0., 10.}}], 
    LineBox[{{10., 0}, {0., 10.}}], LineBox[{{0., 0.}, {0., 10.}}], 
    {RGBColor[0, 0, 1], 
     LineBox[{{-10, 0}, {0.3749999999999998, -1.2803300858899103`}}], 
     LineBox[{{0.3749999999999998, -1.2803300858899103`}, {10.75, 0}}], 
     LineBox[{{-10, 0}, {0.3749999999999998, 9.09466991411009}}], 
     LineBox[{{10.75, 0}, {0.3749999999999998, 9.09466991411009}}], 
     LineBox[{{0.3749999999999998, -1.2803300858899103`}, {0.3749999999999998,
       9.09466991411009}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-10, 0}, {0.7499999999999996, -2.5606601717798205`}}], 
     LineBox[{{0.7499999999999996, -2.5606601717798205`}, {11.5, 0}}], 
     LineBox[{{-10, 0}, {0.7499999999999996, 8.189339828220179}}], 
     LineBox[{{11.5, 0}, {0.7499999999999996, 8.189339828220179}}], 
     LineBox[{{0.7499999999999996, -2.5606601717798205`}, {0.7499999999999996,
       8.189339828220179}}]}}},
  AspectRatio->0.5,
  DisplayFunction->Print,
  ImageSize->300,
  PlotLabel->FormBox[
   "\"Truss orig & 2 deformed shapes\"", TraditionalForm]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.7457622037823677`*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"575d37c2-7d5e-458d-a75b-745b5a63c3f1"],

Cell[BoxData["\<\"Example truss node forces w/ reactions:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203783577*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"ad19eff1-221e-43b9-94e3-aac8dc52e092"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"node\"\>",
       HoldForm], 
      TagBox["\<\"x-force\"\>",
       HoldForm], 
      TagBox["\<\"y-force\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox[
        RowBox[{"\<\"    1.776357\"\>", "\[Times]", 
         SuperscriptBox["10", "\<\"-15\"\>"]}],
        1.7763568394002505`*^-15,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"    7.500000\"\>",
        7.499999999999998,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.000000\"\>",
        0.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"  -15.000000\"\>",
        -15.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox[
        RowBox[{"\<\"   -1.776357\"\>", "\[Times]", 
         SuperscriptBox["10", "\<\"-15\"\>"]}],
        -1.7763568394002505`*^-15,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"    7.500000\"\>",
        7.499999999999998,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]},
     {"\<\"4\"\>", 
      TagBox[
       InterpretationBox["\<\"    0.000000\"\>",
        0.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ], 
      TagBox[
       InterpretationBox["\<\"    0.000000\"\>",
        0.,
        AutoDelete->True],
       PaddedForm[#, {10, 6}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {None, {"node", "x-force", "y-force"}}]]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203784451*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"d5c04763-a539-4a8e-8edf-71e9cebdf89b"],

Cell[BoxData["\<\"Truss elem forces & stresses:\"\>"], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.74576220378546*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"d7cd6794-5fab-42fe-ba69-5909b7130d62"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"elem\"\>",
       HoldForm], 
      TagBox["\<\"axial force\"\>",
       HoldForm], 
      TagBox["\<\"axial stress\"\>",
       HoldForm]},
     {"\<\"1\"\>", 
      TagBox[
       InterpretationBox["\<\"   7.5000\"\>",
        7.499999999999996,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   3.7500\"\>",
        3.749999999999998,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"2\"\>", 
      TagBox[
       InterpretationBox["\<\"   7.5000\"\>",
        7.499999999999996,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   3.7500\"\>",
        3.749999999999998,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"3\"\>", 
      TagBox[
       InterpretationBox["\<\" -10.6066\"\>",
        -10.60660171779821,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"  -2.6517\"\>",
        -2.6516504294495524`,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"4\"\>", 
      TagBox[
       InterpretationBox["\<\" -10.6066\"\>",
        -10.60660171779821,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"  -2.6517\"\>",
        -2.6516504294495524`,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]},
     {"\<\"5\"\>", 
      TagBox[
       InterpretationBox["\<\"  15.0000\"\>",
        14.999999999999996`,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ], 
      TagBox[
       InterpretationBox["\<\"   3.7500\"\>",
        3.749999999999999,
        AutoDelete->True],
       PaddedForm[#, {7, 4}]& ]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Right}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableAlignments -> {Right}, TableDirections -> {Column, Row}, 
    TableSpacing -> {0, 1}, 
    TableHeadings -> {
     None, {"elem", "axial force", "axial stress"}}]]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203786261*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"c1eb8a64-0a2a-42bc-8da5-56c1ce9edb55"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], AbsoluteThickness[0.5], 
    LineBox[{{-11., -1.}, {11., -1.}, {11., 11.}, {-11., 11.}, {-11., -1.}}]}, 
   {RGBColor[1., 4.440892098500626*^-16, 4.440892098500626*^-16], 
    AbsoluteThickness[4], LineBox[{{-10, 0}, {0, 0}}], 
    {RGBColor[1., 4.440892098500626*^-16, 4.440892098500626*^-16], 
     LineBox[{{0, 0}, {10, 0}}]}, 
    {RGBColor[0.29289321881345254`, 0.29289321881345254`, 1.], 
     LineBox[{{-10, 0}, {0, 10}}]}, 
    {RGBColor[0.29289321881345254`, 0.29289321881345254`, 1.], 
     LineBox[{{10, 0}, {0, 10}}]}, 
    {RGBColor[1., 0., 0.], LineBox[{{0, 0}, {0, 10}}]}}},
  AspectRatio->0.5,
  Background->GrayLevel[0],
  DisplayFunction->Print,
  ImageSize->300,
  PlotLabel->FormBox[
   "\"Example truss elem stresses\"", TraditionalForm]]], "Print",
 CellChangeTimes->{
  3.745759423708891*^9, 3.7457595062428226`*^9, {3.745759579292666*^9, 
   3.745759625715028*^9}, 3.745759663883287*^9, 3.745759717098534*^9, 
   3.745759810658918*^9, 3.745759848847089*^9, 3.745760024663434*^9, 
   3.745760904711423*^9, 3.745761058229309*^9, {3.745761170200115*^9, 
   3.745761199500616*^9}, 3.745761242769944*^9, 3.745762203787416*^9},
 CellLabel->
  "During evaluation of \
In[974]:=",ExpressionUUID->"8bb965e6-1a2e-4baf-bb04-819d57e10cc5"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Cell 14.",
  FontWeight->"Bold"],
 "  Script for Exercise 4.1 w/ symbolic a, b, Em, A and P. ",
 StyleBox["Note:",
  FontWeight->"Bold"],
 " Don't forget to \n",
 StyleBox["ClearAll[a,b,Em,A,P]",
  FontWeight->"Bold"],
 " at start! Else it will use numerical  values of previous cell.\nAlso use \
",
 StyleBox["Simplify",
  FontWeight->"Bold"],
 " with assumptions a>0&&b>0"
}], "Text",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"8c818081-b4a0-4687-ae07-189151e79af5"],

Cell[CellGroupData[{

Cell["\<\
ClearAll[a,b,A,A1,A2,A3,A4,A5,fy2,Em];
A1=A; A2=A; A3=2A; A4=2A; A5=2A; fy2=-P;
nodxyz={{-a,0},{0,0},{a,0},{0,b}}; elenod={{1,2},{2,3},{1,4},{3,4},{2,4}};
elemat={Em,Em,Em,Em,Em}; elefab={A1,A2,A3,A4,A5};
nodtag={{1,1},{0,0},{0,1},{0,0}}; nodval={{0,0},{fx2,fy2},{fx3,0},{fx4,fy4}};
Print[\"Node coord of example truss:\",nodxyz];
Print[\"Element data of example truss:\",{elenod,elemat,elefab}];
Print[\"DOF activity of example truss:\",{nodtag,nodval}];
K=PlaneTrussMasterStiffness[nodxyz,elenod,elemat,elefab];
f=AppliedForceVector[nodtag,nodval];
Kmod=ModifiedMasterStiffness[nodtag,K];
fmod=ModifiedNodeForces[nodtag,nodval,K,f];
u=Simplify[LinearSolve[Kmod,fmod]]; noddis=Partition[u,2];
u=FullSimplify[u,a>0&&b>0];
Print[\"Computed node displacements:\",u];
f=Simplify[K.u]; nodfor=Partition[f,2];
f=FullSimplify[f,a>0&&b>0];
Print[\"Node forces including reactions:\",f];
elefor=PlaneTrussIntForces[nodxyz,elenod,elemat,elefab,noddis];
elesig=PlaneTrussStresses[elefab,elefor];
elefor=FullSimplify[elefor,a>0&&b>0]; elesig=FullSimplify[elesig,a>0&&b>0];
Print[\"Elem forces: \",elefor]; Print[\"Elem stresses: \",elesig];\
\>", "Input",
 CellFrame->True,
 CellMargins->{{11, 9}, {Inherited, Inherited}},
 CellLabelMargins->{{7, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.745761283590767*^9, 3.745761290127721*^9}, {
   3.745761330345604*^9, 3.745761366903213*^9}, {3.745761460303673*^9, 
   3.745761618862052*^9}, {3.7457616597065887`*^9, 3.745761678747971*^9}, {
   3.7457618876919203`*^9, 3.745761902749201*^9}, 3.7457619349165783`*^9, {
   3.745761979406288*^9, 3.745762006402276*^9}, {3.745762043706663*^9, 
   3.745762044068069*^9}, {3.745762130239167*^9, 3.7457621344217777`*^9}, {
   3.7457621930351048`*^9, 3.7457621993110723`*^9}, {3.7457622467431383`*^9, 
   3.7457622499328127`*^9}, {3.745762281391204*^9, 3.7457622872456284`*^9}, {
   3.745762353709453*^9, 3.745762415928307*^9}, {3.74576248034492*^9, 
   3.7457625061186657`*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[1123]:=",ExpressionUUID->"e0d38257-f924-42a4-9f99-9c6310b55163"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node coord of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "b"}], "}"}]}], "}"}]}],
  SequenceForm[
  "Node coord of example truss:", {{-$CellContext`a, 0}, {0, 
    0}, {$CellContext`a, 0}, {0, $CellContext`b}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.7457625066311483`*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"0218656a-88f6-4949-bfb8-d2faa57f5ee5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Element data of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Em", ",", "Em", ",", "Em", ",", "Em", ",", "Em"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"A", ",", "A", ",", 
       RowBox[{"2", " ", "A"}], ",", 
       RowBox[{"2", " ", "A"}], ",", 
       RowBox[{"2", " ", "A"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "Element data of example truss:", {{{1, 2}, {2, 3}, {1, 4}, {3, 4}, {2, 
    4}}, {$CellContext`Em, $CellContext`Em, $CellContext`Em, $CellContext`Em, \
$CellContext`Em}, {$CellContext`A, $CellContext`A, 2 $CellContext`A, 
     2 $CellContext`A, 2 $CellContext`A}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.745762506635048*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"6e52c8cc-645c-45be-967b-d2083dddcfca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"DOF activity of example truss:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "P"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "DOF activity of example truss:", {{{1, 1}, {0, 0}, {0, 1}, {0, 
    0}}, {{0, 0}, {0, -$CellContext`P}, {0, 0}, {0, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.745762506637183*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"d78bd20b-be0b-4135-8d56-0bd503561317"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Computed node displacements:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "2"], " ", "P"}], 
      RowBox[{"2", " ", "A", " ", "b", " ", "Em"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["a", "3"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "b"}], "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["b", "2"]}]]}], ")"}]}]}], ")"}], " ", "P"}], 
       RowBox[{"4", " ", "A", " ", 
        SuperscriptBox["b", "2"], " ", "Em"}]]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "2"], " ", "P"}], 
      RowBox[{"A", " ", "b", " ", "Em"}]], ",", "0", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "2"], " ", "P"}], 
      RowBox[{"2", " ", "A", " ", "b", " ", "Em"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["a", "3"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             SuperscriptBox["b", "2"]}]]}]}], ")"}], " ", "P"}], 
       RowBox[{"4", " ", "A", " ", 
        SuperscriptBox["b", "2"], " ", "Em"}]]}]}], "}"}]}],
  SequenceForm[
  "Computed node displacements:", {
   0, 0, Rational[
     1, 2] $CellContext`a^2 $CellContext`A^(-1) $CellContext`b^(-1) \
$CellContext`Em^(-1) $CellContext`P, 
    Rational[-1, 4] $CellContext`A^(-1) $CellContext`b^(-2) (
     2 $CellContext`a^3 + $CellContext`a^2 ($CellContext`a^2 + \
$CellContext`b^2)^Rational[1, 2] + $CellContext`b^2 (
       2 $CellContext`b + ($CellContext`a^2 + $CellContext`b^2)^
        Rational[
         1, 2])) $CellContext`Em^(-1) $CellContext`P, $CellContext`a^2 \
$CellContext`A^(-1) $CellContext`b^(-1) $CellContext`Em^(-1) $CellContext`P, 
    0, Rational[
     1, 2] $CellContext`a^2 $CellContext`A^(-1) $CellContext`b^(-1) \
$CellContext`Em^(-1) $CellContext`P, 
    Rational[-1, 4] $CellContext`A^(-1) $CellContext`b^(-2) (
     2 $CellContext`a^3 + $CellContext`a^2 ($CellContext`a^2 + \
$CellContext`b^2)^
       Rational[
        1, 2] + $CellContext`b^2 ($CellContext`a^2 + $CellContext`b^2)^
       Rational[1, 2]) $CellContext`Em^(-1) $CellContext`P}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.745762506657069*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"9bf9b1a7-f200-495a-a654-1c89a5435a8c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Node forces including reactions:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["P", "2"], ",", "0", ",", 
     RowBox[{"-", "P"}], ",", "0", ",", 
     FractionBox["P", "2"], ",", "0", ",", "0"}], "}"}]}],
  SequenceForm[
  "Node forces including reactions:", {
   0, Rational[1, 2] $CellContext`P, 0, -$CellContext`P, 0, 
    Rational[1, 2] $CellContext`P, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.745762506658391*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"a033168d-880d-4b09-b722-3f2c368b54ae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem forces: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", "P"}], 
      RowBox[{"2", " ", "b"}]], ",", 
     FractionBox[
      RowBox[{"a", " ", "P"}], 
      RowBox[{"2", " ", "b"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"]}]], " ", "P"}], 
       RowBox[{"2", " ", "b"}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"]}]], " ", "P"}], 
       RowBox[{"2", " ", "b"}]]}], ",", "P"}], "}"}]}],
  SequenceForm[
  "Elem forces: ", {
   Rational[1, 2] $CellContext`a $CellContext`b^(-1) $CellContext`P, 
    Rational[1, 2] $CellContext`a $CellContext`b^(-1) $CellContext`P, 
    Rational[-1, 2] $CellContext`b^(-1) ($CellContext`a^2 + $CellContext`b^2)^
     Rational[1, 2] $CellContext`P, 
    Rational[-1, 2] $CellContext`b^(-1) ($CellContext`a^2 + $CellContext`b^2)^
     Rational[1, 2] $CellContext`P, $CellContext`P}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.745762506674149*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"74bc63ce-a0bf-4c9a-b3ba-23568522c65d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elem stresses: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", "P"}], 
      RowBox[{"2", " ", "A", " ", "b"}]], ",", 
     FractionBox[
      RowBox[{"a", " ", "P"}], 
      RowBox[{"2", " ", "A", " ", "b"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"]}]], " ", "P"}], 
       RowBox[{"4", " ", "A", " ", "b"}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"]}]], " ", "P"}], 
       RowBox[{"4", " ", "A", " ", "b"}]]}], ",", 
     FractionBox["P", 
      RowBox[{"2", " ", "A"}]]}], "}"}]}],
  SequenceForm[
  "Elem stresses: ", {
   Rational[1, 
      2] $CellContext`a $CellContext`A^(-1) $CellContext`b^(-1) \
$CellContext`P, 
    Rational[1, 
      2] $CellContext`a $CellContext`A^(-1) $CellContext`b^(-1) \
$CellContext`P, 
    Rational[-1, 
      4] $CellContext`A^(-1) $CellContext`b^(-1) ($CellContext`a^2 + \
$CellContext`b^2)^Rational[1, 2] $CellContext`P, 
    Rational[-1, 
      4] $CellContext`A^(-1) $CellContext`b^(-1) ($CellContext`a^2 + \
$CellContext`b^2)^Rational[1, 2] $CellContext`P, 
    Rational[1, 2] $CellContext`A^(-1) $CellContext`P}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.745761525105796*^9, 3.745761546259963*^9}, {
   3.745761584751532*^9, 3.74576161944071*^9}, {3.745761656094389*^9, 
   3.745761679679223*^9}, 3.745761904193647*^9, 3.7457619354959517`*^9, {
   3.745761979907487*^9, 3.745762006855631*^9}, 3.7457620451863213`*^9, 
   3.745762135172535*^9, 3.745762209301565*^9, 3.745762250544298*^9, 
   3.745762288051414*^9, {3.7457623544357653`*^9, 3.745762362246977*^9}, 
   3.745762416744897*^9, 3.7457625066754503`*^9},
 CellLabel->
  "During evaluation of \
In[1123]:=",ExpressionUUID->"567589a7-7ab6-486d-875d-ce9a8d74c221"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7457616575747967`*^9},ExpressionUUID->"d6636255-ba3c-41c0-807c-\
effec972a011"]
},
AutoGeneratedPackage->None,
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{1920, 1154},
WindowMargins->{{-1920, Automatic}, {252, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowCellLabel->True,
ShowCellTags->False,
Magnification->1.5,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, 
  WindowMargins -> {{-1560, Automatic}, {Automatic, -152}}, Visible -> False, 
  FrontEndVersion -> "11.3 for Linux x86 (64-bit) (March 6, 2018)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
PrivateNotebookOptions -> {"ColorPalette" -> {RGBColor, -1}},
RenderingOptions -> {"ObjectDithering" -> True},
RenderingOptions -> {"RasterDithering" -> False},
MacintoshSystemPageSetup -> \
"00<0001804P000000]P2:?oQon82n@960dL5:0?l0080001804P000000]P2:001\n\
0000I00000400`<300000BL?00400@00000000000000060801T1T00000000000\n\
00000000000000000000000000000000"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1702, 36, 474, "Text",ExpressionUUID->"99c0207a-b215-49b5-a08b-8cfc8dd34344"],
Cell[2263, 58, 420, 11, 80, "Text",ExpressionUUID->"ed527a14-88e0-4da5-b042-bead67c80f1f"],
Cell[CellGroupData[{
Cell[2708, 73, 1088, 21, 495, "Input",ExpressionUUID->"f1a263b5-4df1-428f-9020-5de24e4960a4",
 InitializationCell->True],
Cell[3799, 96, 1370, 38, 107, "Print",ExpressionUUID->"44c41cbc-d905-4730-b4e9-de8ca1df8aa0"],
Cell[5172, 136, 5971, 170, 179, "Print",ExpressionUUID->"088ddd78-dba5-47ca-9c9a-96e0ca030f0c"]
}, Open  ]],
Cell[11158, 309, 385, 10, 80, "Text",ExpressionUUID->"3add9e48-c5a1-4fce-9220-b4c31ce09fd3"],
Cell[CellGroupData[{
Cell[11568, 323, 1230, 23, 609, "Input",ExpressionUUID->"9861b3eb-a3f0-4515-a1f1-2ff73b25ed47",
 InitializationCell->True],
Cell[12801, 348, 1677, 46, 157, "Print",ExpressionUUID->"14a9e49e-9222-453b-9016-372055fd9d96"]
}, Open  ]],
Cell[14493, 397, 545, 12, 116, "Text",ExpressionUUID->"adde7bf0-3bea-4eda-a799-9936c96a19d1"],
Cell[CellGroupData[{
Cell[15063, 413, 2681, 53, 1493, "Input",ExpressionUUID->"68b32348-52af-4795-9126-c01785521edd",
 InitializationCell->True],
Cell[17747, 468, 1910, 40, 157, "Print",ExpressionUUID->"6fa96954-6347-4c61-b0a7-30254e6242c5"],
Cell[19660, 510, 464, 11, 36, "Print",ExpressionUUID->"9d03654b-d246-431d-a336-81c1b1335eeb"],
Cell[20127, 523, 1467, 35, 157, "Print",ExpressionUUID->"a9061036-da1f-4306-9cea-08e4e26557da"],
Cell[21597, 560, 1001, 25, 36, "Print",ExpressionUUID->"eb023cb6-2fbe-4392-b990-c72364aeeb5b"]
}, Open  ]],
Cell[22613, 588, 402, 10, 80, "Text",ExpressionUUID->"4851dbbf-2dc3-4d8d-80b8-4e5139f9e8ff"],
Cell[CellGroupData[{
Cell[23040, 602, 876, 19, 381, "Input",ExpressionUUID->"f3265032-5223-401d-bbf1-6219facda383",
 InitializationCell->True],
Cell[23919, 623, 429, 10, 36, "Print",ExpressionUUID->"e07da477-d295-4b4e-ac11-07ffd272b2e4"],
Cell[24351, 635, 729, 19, 58, "Print",ExpressionUUID->"5d3be4d1-18e1-4708-a72e-5e5a50281860"]
}, Open  ]],
Cell[25095, 657, 393, 10, 80, "Text",ExpressionUUID->"3984a890-fb5a-4658-912c-5b0b3e551707"],
Cell[CellGroupData[{
Cell[25513, 671, 1401, 27, 723, "Input",ExpressionUUID->"7b2405e8-50b3-4899-8ec4-41e553f2b7c6",
 InitializationCell->True],
Cell[26917, 700, 543, 14, 36, "Print",ExpressionUUID->"b1cc7aa7-e1e1-4eb6-a0b1-37e35210dde5"],
Cell[27463, 716, 488, 12, 36, "Print",ExpressionUUID->"96416fc0-ff93-499b-89a9-47764618a0df"]
}, Open  ]],
Cell[27966, 731, 411, 11, 80, "Text",ExpressionUUID->"79c1e5c3-f686-4184-b173-61f563cf5145",
 InitializationCell->True],
Cell[28380, 744, 5318, 85, 2946, "Input",ExpressionUUID->"fcdab949-dd7b-45ce-869d-d43ec15c3414",
 InitializationCell->True],
Cell[33701, 831, 496, 14, 80, "Text",ExpressionUUID->"42c6ca91-2147-4a35-9992-965a4af84f18",
 InitializationCell->True],
Cell[34200, 847, 5119, 83, 2775, "Input",ExpressionUUID->"2d01e7f0-2684-4c51-8f6c-297ff926e212",
 InitializationCell->True],
Cell[39322, 932, 385, 11, 80, "Text",ExpressionUUID->"aacd0353-6210-435e-a707-786abfea16a9",
 InitializationCell->True],
Cell[39710, 945, 3630, 61, 1778, "Input",ExpressionUUID->"7e54e232-5cca-4583-8b1c-3084a6b83663",
 InitializationCell->True],
Cell[43343, 1008, 385, 11, 80, "Text",ExpressionUUID->"f68777bd-3e7a-4ee1-9578-33df1e6ee3c0",
 InitializationCell->True],
Cell[43731, 1021, 3189, 56, 1721, "Input",ExpressionUUID->"c82b496a-242a-450d-be9b-ecbf9d6267ed",
 InitializationCell->True],
Cell[46923, 1079, 378, 10, 80, "Text",ExpressionUUID->"c51f8354-cdf2-4cd7-bd8e-bfa614559c4f"],
Cell[CellGroupData[{
Cell[47326, 1093, 2327, 49, 980, "Input",ExpressionUUID->"0e193273-b65a-4871-986a-94f2e33c44e4"],
Cell[49656, 1144, 235, 4, 81, "Print",ExpressionUUID->"a1f68bb3-ac5b-4a99-b30b-c05e3c7ead2a"],
Cell[49894, 1150, 2012, 66, 198, "Print",ExpressionUUID->"d49fed11-dce8-415b-aef3-39bb03422b5e"],
Cell[51909, 1218, 233, 4, 81, "Print",ExpressionUUID->"f3b66222-c029-47a1-908c-65e91da35635"],
Cell[52145, 1224, 2157, 68, 204, "Print",ExpressionUUID->"0b959b29-1cee-40ce-aa4b-ec544e802fc5"],
Cell[54305, 1294, 234, 4, 81, "Print",ExpressionUUID->"fb4b8be4-5fed-4b02-9b63-743fc04b0c9c"],
Cell[54542, 1300, 2693, 101, 198, "Print",ExpressionUUID->"da520e1f-c928-40aa-8542-2b813f159eaf"],
Cell[57238, 1403, 1914, 39, 416, "Print",ExpressionUUID->"f2dfdfa3-583e-4423-8171-ad9628dc66e0"],
Cell[59155, 1444, 2746, 70, 157, "Print",ExpressionUUID->"a22f60da-ff62-4ec0-990b-0488abd435c3"],
Cell[61904, 1516, 1852, 57, 157, "Print",ExpressionUUID->"9ab76ad3-80a8-46a6-a760-6f35d22d4978"],
Cell[63759, 1575, 239, 4, 36, "Print",ExpressionUUID->"26c672e3-2813-4dd7-b6d0-80e707e5633c"],
Cell[64001, 1581, 2054, 66, 88, "Print",ExpressionUUID->"583b9e5a-a0b6-4507-a08a-c369e4085171"],
Cell[66058, 1649, 874, 18, 412, "Print",ExpressionUUID->"470495ce-9edb-4a3b-aacb-0996c74ac242"],
Cell[66935, 1669, 243, 4, 36, "Print",ExpressionUUID->"e5197121-08b7-4e71-b693-7960b1a708ff"],
Cell[67181, 1675, 2063, 66, 88, "Print",ExpressionUUID->"adad71d5-96cd-4dbc-91a8-416b799e8478"],
Cell[69247, 1743, 241, 4, 36, "Print",ExpressionUUID->"19684a13-005a-49e1-957f-5d5daa2fd4e0"],
Cell[69491, 1749, 2074, 67, 88, "Print",ExpressionUUID->"f998d12c-e433-4dec-b4ad-51d6bd7de4ce"],
Cell[71568, 1818, 710, 17, 412, "Print",ExpressionUUID->"bbe041a7-5f3e-47a5-91c6-d3ff178d524a"]
}, Open  ]],
Cell[72293, 1838, 482, 13, 80, "Text",ExpressionUUID->"5799532a-b638-425a-90bd-ad1165584781"],
Cell[CellGroupData[{
Cell[72800, 1855, 1208, 26, 581, "Input",ExpressionUUID->"7d5b8866-78c1-493a-b18e-c3dc2d0f05cd"],
Cell[74011, 1883, 609, 16, 36, "Print",ExpressionUUID->"c6200c31-cff7-414e-bd42-84b348366c66"],
Cell[74623, 1901, 960, 28, 58, "Print",ExpressionUUID->"dc632913-548b-4271-b9ff-0b2a872fbe0e"],
Cell[75586, 1931, 999, 29, 36, "Print",ExpressionUUID->"5278dfba-4074-4caa-8830-3a9f90b1e70f"],
Cell[76588, 1962, 954, 26, 59, "Print",ExpressionUUID->"d79c1342-fd5f-4022-b5ec-bfade9dfb9b8"],
Cell[77545, 1990, 724, 17, 36, "Print",ExpressionUUID->"d1f72fc6-6a6f-45ce-bede-fa065642f480"],
Cell[78272, 2009, 907, 25, 43, "Print",ExpressionUUID->"c65cd925-7a2f-4819-a99e-132f079057d5"],
Cell[79182, 2036, 984, 28, 58, "Print",ExpressionUUID->"0f66d559-3145-46d2-89e3-856e7765f387"]
}, Open  ]],
Cell[80181, 2067, 458, 12, 80, "Text",ExpressionUUID->"e45cb9bf-ed0e-4357-b6a7-ba21dd021a64"],
Cell[CellGroupData[{
Cell[80664, 2083, 1322, 29, 666, "Input",ExpressionUUID->"ba3c56a6-a56d-4b8f-bf9a-a7bceb772eab"],
Cell[81989, 2114, 652, 18, 36, "Print",ExpressionUUID->"066b9243-f1ca-43e8-8f91-e4a2d376e665"],
Cell[82644, 2134, 934, 25, 36, "Print",ExpressionUUID->"22930350-a6a7-4c0e-8def-db1c2d09963c"],
Cell[83581, 2161, 999, 29, 36, "Print",ExpressionUUID->"c917411c-ed53-400e-82b8-d97e91fa3398"],
Cell[84583, 2192, 1866, 48, 67, "Print",ExpressionUUID->"dc1122e8-ccf8-46e8-9a11-31fa21bafe45"],
Cell[86452, 2242, 908, 23, 59, "Print",ExpressionUUID->"e78d667d-302c-41f1-87ea-2f35e01cdcca"],
Cell[87363, 2267, 849, 23, 72, "Print",ExpressionUUID->"6a7429ec-667b-4823-afd0-5c0affcce52a"],
Cell[88215, 2292, 1002, 27, 72, "Print",ExpressionUUID->"c76ced9d-6864-4646-9c1c-25e38d02ea96"]
}, Open  ]],
Cell[89232, 2322, 335, 9, 80, "Text",ExpressionUUID->"24a2fe85-647e-463f-a203-47c5e3e0a6b0"],
Cell[CellGroupData[{
Cell[89592, 2335, 3902, 69, 980, "Input",ExpressionUUID->"6350a9ee-727b-4e9e-a063-b7fc095ffa3d"],
Cell[93497, 2406, 536, 9, 36, "Print",ExpressionUUID->"60dbcd5a-032e-411e-aa99-a7342a350c58"],
Cell[94036, 2417, 2602, 82, 106, "Print",ExpressionUUID->"99712cca-d378-4937-a8d7-0204e09cd312"],
Cell[96641, 2501, 536, 9, 36, "Print",ExpressionUUID->"7a009546-afc9-42a9-964d-4d775e25f3cd"],
Cell[97180, 2512, 3059, 96, 129, "Print",ExpressionUUID->"404b2055-2daa-40a9-af29-20bed6a41d95"],
Cell[100242, 2610, 539, 9, 36, "Print",ExpressionUUID->"f65219f5-1422-4865-b106-7b5944b6c520"],
Cell[100784, 2621, 3471, 127, 106, "Print",ExpressionUUID->"acdca29e-7d63-48c4-a93e-390cdd7eab4c"],
Cell[104258, 2750, 2830, 53, 265, "Print",ExpressionUUID->"06596b2a-9277-44c6-bee9-5b5cd0d8dfe3"],
Cell[107091, 2805, 5092, 111, 207, "Print",ExpressionUUID->"09da85fc-069c-45e3-ac67-3be749f2be9f"],
Cell[112186, 2918, 2291, 68, 207, "Print",ExpressionUUID->"c1bbb92d-de75-48ad-be87-8479c3027158"],
Cell[114480, 2988, 542, 9, 36, "Print",ExpressionUUID->"434a71ad-c5d4-4663-ae66-ed19a9011acc"],
Cell[115025, 2999, 2739, 82, 106, "Print",ExpressionUUID->"6f54324b-b92f-48e0-973a-c34d1baa51db"],
Cell[117767, 3083, 1843, 35, 263, "Print",ExpressionUUID->"575d37c2-7d5e-458d-a75b-745b5a63c3f1"],
Cell[119613, 3120, 554, 9, 36, "Print",ExpressionUUID->"ad19eff1-221e-43b9-94e3-aac8dc52e092"],
Cell[120170, 3131, 2899, 86, 116, "Print",ExpressionUUID->"d5c04763-a539-4a8e-8edf-71e9cebdf89b"],
Cell[123072, 3219, 543, 9, 36, "Print",ExpressionUUID->"d7cd6794-5fab-42fe-ba69-5909b7130d62"],
Cell[123618, 3230, 3104, 94, 124, "Print",ExpressionUUID->"c1eb8a64-0a2a-42bc-8da5-56c1ce9edb55"],
Cell[126725, 3326, 1298, 27, 262, "Print",ExpressionUUID->"8bb965e6-1a2e-4baf-bb04-819d57e10cc5"]
}, Open  ]],
Cell[128038, 3356, 631, 19, 151, "Text",ExpressionUUID->"8c818081-b4a0-4687-ae07-189151e79af5"],
Cell[CellGroupData[{
Cell[128694, 3379, 2093, 39, 695, "Input",ExpressionUUID->"e0d38257-f924-42a4-9f99-9c6310b55163"],
Cell[130790, 3420, 1161, 27, 36, "Print",ExpressionUUID->"0218656a-88f6-4949-bfb8-d2faa57f5ee5"],
Cell[131954, 3449, 1700, 40, 36, "Print",ExpressionUUID->"6e52c8cc-645c-45be-967b-d2083dddcfca"],
Cell[133657, 3491, 1545, 39, 36, "Print",ExpressionUUID->"d78bd20b-be0b-4135-8d56-0bd503561317"],
Cell[135205, 3532, 3655, 93, 84, "Print",ExpressionUUID->"9bf9b1a7-f200-495a-a654-1c89a5435a8c"],
Cell[138863, 3627, 1067, 22, 58, "Print",ExpressionUUID->"a033168d-880d-4b09-b722-3f2c368b54ae"],
Cell[139933, 3651, 1800, 45, 72, "Print",ExpressionUUID->"74bc63ce-a0bf-4c9a-b3ba-23568522c65d"],
Cell[141736, 3698, 2041, 54, 72, "Print",ExpressionUUID->"567589a7-7ab6-486d-875d-ce9a8d74c221"]
}, Open  ]],
Cell[143792, 3755, 149, 3, 82, "Input",ExpressionUUID->"d6636255-ba3c-41c0-807c-effec972a011"]
}
]
*)

